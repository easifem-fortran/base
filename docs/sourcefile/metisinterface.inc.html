<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A frame work for Expandable And Scalable Infrastructure for Finite Element Methods">
    
    <meta name="author" content="Vikas Sharma" >
    <link rel="icon" href="../favicon.png">

    <title>MetisInterface.inc &ndash; EASIFEM-BASE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EASIFEM-BASE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>easifemBase</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>




          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>MetisInterface.inc
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a></li> 
     
     
     
    
    
     
     
    <li><i class="fa fa-code"></i><a href="../src/MetisInterface.inc"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">MetisInterface.inc</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/metisinterface.inc.html#src">MetisInterface.inc</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p>Maximum number of METSI OPTIONS</p>
<p>Flag to indicate that there is no error</p>
<p>Flag to indicate that there is erro during input output</p>
<p>Flag to indicate error due to the insufficient memory.</p>
<p>Flag to indicate undocumented error</p>
<p>It specifies the type of partitioning method; The possible values are
given below.</p>
<p>Multilevel recursive bisectioning.</p>
<p>Multilevel k-way partitioning. DEFAULT</p>
<p>Default value of METIS_OPTION_PTYPE</p>
<p>Specifies the objective type, two values are possible: Edge-cut, which
minimizes the communication time, and Total communication volume</p>
<p>Edge-cut minimization.</p>
<p>Total communication volume minimization.</p>
<p>Specifies the matching scheme to be used during coarsening. Possible
values are as follows:</p>
<p>Random matching.</p>
<p>Sorted heavy-edge matching.</p>
<p>Specify the algorithm used during the initial partitioning of the mesh</p>
<p>grows bisection using a greedy strategy.</p>
<p>computes bisection at random followed by a refinement.</p>
<p>derives separator form an edge cut.</p>
<p>grows bisection using a greedy node-based strategy.</p>
<p>Specify the algorithm used for refinement.</p>
<p>FM-basecut refinement.</p>
<p>Greedy-based cut and volume refinement.</p>
<p>Two-sidenode FM refinement.</p>
<p>One-sidenode FM refinement.</p>
<p>Specifies the amount of progress/debugging information will be printed during the execution of the algorithms. The default value is 0 (no debugging/progress information). A non-zero value can be supplied that is obtained by a bit-wise OR of the following values</p>
<p>Shows various diagnostic messages.</p>
<p>Perform timing analysis.</p>
<p>Shothe coarsening progress.</p>
<p>Shothe refinement progress.</p>
<p>Shoinfo on initial partitioning.</p>
<p>Shoinfo on vertex moves during refinement.</p>
<p>Shoinfo on vertex moves during sep refinement.</p>
<p>Shoinfo on minimization of subdomain connectivity.</p>
<p>Shoinfo on elimination of connected components.</p>
<p>Shoinfo related to wspace allocation.</p>
<p>Specifies the number of iterations for the refinement algorithm.
Default value is 10</p>
<p>Specifies the number of different partitionings that it will compute. The final partitioning is the one that achieves the best edgecut or communication volume. Default is 1</p>
<p>Specifies the seed for the random number generator.</p>
<p>Specifies that the coarsening will not perform any 2–hop matchings when the standard matching approach fails to sufficiently coarsen the graph. The 2–hop matching is very effective for graphs with power-law degree distributions.
- 0 means perform 2-hop matching
- 1 means do not perform 2-hop matching</p>
<p>Specifies that the partitioning routines should try to minimize the maximum degree of the subdomain graph, i.e., the graph in which each partition is a node, and edges connect subdomains with a shared interface.
0 Does not explicitly minimize the maximum connectivity
1 explicitly minimize the maximum connectivity</p>
<p>Specifies that the partitioning routines should try to produce partitionsthat are contigous. If the input graph is not connected then this option is ignored
- 0 does not force contiguous partition
- 1 does force contingous partition</p>
<p>Specifies that the graph should be compressed by combining togethervertices that have identical adjacency lists.
O- does not compress
1 compress</p>
<p>Specifies if the connected components of the graph should first be identifies and ordered separately.</p>
<p>Specifies the minimum degree of the vertices that will be ordered last.
If the specified value is x &gt; 0, then
any vertices with a degree greater than 0.1<em>x</em>(average degree) are removed from the graph, an ordering of
the rest of the vertices is computed, and an overall ordering is computed by ordering the removed vertices
at the end of the overall ordering. For example if x = 40, and the average degree is 5, then the algorithm
will remove all vertices with degree greater than 20. The vertices that are removed are ordered last (i.e.,
they are automatically placed in the top-level separator). Good values are often in the range of 60 to 200
(i.e., 6 to 20 times more than the average). Default value is 0, indicating that no vertices are removed.
Used to control whether or not the ordering algorithm should remove any vertices with high degree (i.e.,
dense columns). This is particularly helpful for certain classes of LP matrices, in which there a few vertices
that are connected to many other vertices. By removing these vertices prior to ordering, the quality and the
amount of time required to do the ordering improves</p>
<p>Specifies the number of different separators that it will compute at each level of nested dissection. The final separator that is used is the smallest one. Default is 1</p>
<p>Specifies the maximum allowed load imbalance among the partitions. A
value of x indicates that the allowed load imbalance is (1 + x)=1000.
The load imbalance for the jth constraint is defined to be maxi(w[j; i])
=t[j; i]), where w[j; i] is the fraction of the overall weight of the
jth constraint that is assigned to the ith partition and t[j; i] is the
desired target weight of the jth constraint for the ith partition (i.e.,
that specified via -tpwgts). For -ptype=rb, the default value is 1 (i.e.
, load imbalance of 1.001) and for -ptype=kway, the default value is 30
(i.e., load imbalance of 1.03).</p>
<p>Used to indicate which numbering scheme is used for the adjacency structure of a graph or the element-node structure of a mesh.
The possible values are 0 for C-style, and 1 for Fortran style</p>
<p>authors: Vikas Sharma, Ph. D.
date: 27 July 2021
summary: Initializes the options array into its default values.</p>
<h3 id="introduction">Introduction</h3>
<p>Initializes the options array into its default values.</p>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>The passed array <code>options</code> must have the size <code>MAX_METIS_OPTIONS</code> (40).
To be able to use the option parameters specified in the <a>metis_interface</a> module
it is recommended to use zero-based indexing for the options array:</p>
<div class="codehilite"><pre><span></span><code><span class="kt">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">opts</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">39</span><span class="p">)</span>
</code></pre></div>

<p></p></div>
<p>
<p>Other options can also be changed using parameters specified in the <a>metis_interface</a> module.</p>
<p>The array of options that will be initialized.</p>
<p><code>METIS_OK</code> - Indicates that the function returned normally.</p>
<p>authors: Vikas Sharma, Ph. D.
date: 27 July 2021
summary: This function computes fill reducing orderings of sparse matrices using the multilevel nested dissection algorithm.</p>
<h3 id="introduction_1">Introduction</h3>
<p>This function computes fill reducing orderings of sparse matrices using the
multilevel nested dissection algorithm.</p>
<p>Let $A$ be the original matrix and $A<em>$ be the permuted matrix.
The arrays <code>perm</code> and <code>iperm</code> are defined as follows. Row (column) <code>i</code> of $A</em>$ is the <code>perm(i)</code> row (column) of $A$, and row (column) <code>i</code> of $A$ is the <code>iperm(i)</code> row (column) of $A*$.
The numbering of this vector starts from either 0 or 1, depending on the value of <code>options(METIS_OPTION_NUMBERING)</code>.</p>
<p>If the graph is weighted, meaning <code>vgwt</code> was provided, the nested dissection ordering computes vertex separators that minimize the sum of the weights of the vertices on the separators.</p>
<p>THE FOLLOWING OPTIONS ARE VALID:</p>
<ul>
<li><code>METIS_OPTION_CTYPE</code></li>
<li><code>METIS_OPTION_RTYPE</code></li>
<li><code>METIS_OPTION_NO2HOP</code></li>
<li><code>METIS_OPTION_NSEPS</code></li>
<li><code>METIS_OPTION_NITER</code></li>
<li><code>METIS_OPTION_UFACTOR</code></li>
<li><code>METIS_OPTION_COMPRESS</code></li>
<li><code>METIS_OPTION_CCORDER</code></li>
<li><code>METIS_OPTION_SEED</code></li>
<li><code>METIS_OPTION_PFACTOR</code></li>
<li><code>METIS_OPTION_NUMBERING</code></li>
<li><code>METIS_OPTION_DBGLVL</code></li>
</ul>
<p>CInterface
int METIS_NodeND(idx_t <em>nvtxs, idx_t </em>xadj, idx_t <em>adjncy, idx_t </em>vwgt, idx_t <em>options, idx_t </em>perm, idx_t *iperm)</p>
<p>Optional argument : vwgt, options</p>
<p>The number of vertices in the graph.</p>
<p>The adjacency structure of the graph as described in Section 5.5 of
the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>An array of size <code>nvtxs</code> specifying the weights of the vertices.</p>
<p>This is the array of options as described in Section 5.4 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>. See description for valid options.</p>
<p>These are vectors, each of size nvtxs. Upon successful completion,
they store the fill-reducing permutation and inverse-permutation. Let
A be the original matrix and $A<em>$ be the permuted matrix.
The arrays <code>perm</code> and <code>iperm</code> are defined as follows.
Row (or, column) $i$ of $A</em>$ is the <code>perm[i]</code> row (column) of A,
and row (column) $i$ of $A$ is the <code>iperm[i]</code> row (column) of A0.
The numbering of this vector starts from either 0 or 1,
depending on the value of options[METIS OPTION NUMBERING]</p>
<p><code>METIS_OK</code> - Indicates that the function returned normally.<br />
<code>METIS_ERROR_INPUT</code> - Indicates an input error.<br />
<code>METIS_ERROR_MEMORY</code> - Indicates that it could not allocate the required memory.<br />
<code>METIS_ERROR</code> - Indicates some other type of error.</p>
<p>authors: Vikas Sharma, Ph. D.
date: 27 July 2021
summary: this function is used to partition a graph into <code>nparts</code>
parts using recursive bisection.</p>
<h3 id="introduction_2">Introduction</h3>
<p>This function is used to partition a graph into <code>nparts</code> parts using
recursive bisection.</p>
<p>THE FOLLOWING OPTIONS ARE VALID:</p>
<ul>
<li><code>METIS_OPTION_CTYPE</code></li>
<li><code>METIS_OPTION_IPTYPE</code></li>
<li><code>METIS_OPTION_RTYPE</code></li>
<li><code>METIS_OPTION_NO2HOP</code></li>
<li><code>METIS_OPTION_NCUTS</code></li>
<li><code>METIS_OPTION_NITER</code></li>
<li><code>METIS_OPTION_SEED</code></li>
<li><code>METIS_OPTION_UFACTOR</code></li>
<li><code>METIS_OPTION_NUMBERING</code></li>
<li><code>METIS_OPTION_DBGLVL</code></li>
</ul>
<p>OPTIONAL :: VWGT, VSIZE, ADJWGT, TPWGTS, UBVEC, OPTIONS</p>
<p>int_METIS_PartGraphRecursive(idx_t <em>nvtxs, idx_t </em>ncon, idx_t <em>xadj, idx_t ! </em>adjncy, idx_t <em>vwgt, idx_t </em>vsize, idx_t <em>adjwgt, idx_t </em>nparts, real_t <em>tpwgts, real_t </em>ubvec, idx_t <em>options, idx_t </em>objval, idx_t *part)</p>
<p>The number of vertices in the graph.</p>
<p>The number of balancing constraints on each node.
It should be atleast 1.</p>
<p>The adjacency structure of the graph as described in
section 5.5 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The weights of the vertices as described in Section 5.5 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The size of the vertices for computing the total communication volume
as described in section 5.7 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The weights of the edges as describe in Section 5.5 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The number of parts to partition the graph.</p>
<p>This is an array pf size<code>nparts*ncon</code> that specifies the desired
weight for each partition and constraint.
The target partition weight for the ith partition and
jth constraint is specified at <code>tpwgts[i*ncon+j]</code>.
The numbering for both partition and constraints starts from 0.
For each constraint, the sum of the <code>tpwgts[]</code> entries must be 1.0.
If not present, the graph is divided equally among the partitions.
More in the description.</p>
<p>An array of size <code>ncon</code> that specifies the allowed load imbalance
for each constraint.
For the <code>i</code>-th partition and <code>j</code>-th constraint the allowed
weight is the <code>ubvec(j)*tpwgts(i*ncon+j)</code>
fraction of the <code>j</code>-th&rsquo;s constraint total weight.
If not present, the load imbalance
tolerance is 1.001 (for <code>ncon = 1</code>) or 1.01 (for <code>ncon &gt; 1</code>).</p>
<p>An array of options as described in Section 5.4 of the METIS manual.
See description for valid options.</p>
<p>Upon successful completion, this variable stores the edge-cut or the
total communication volume of the partitioning
solution. The value returned depends on the partitioning&rsquo;s objective
function.</p>
<p>This is a vector of size <code>nvtxs</code> that upon successful completion
stores the partition vector of the graph.
The numbering of this vector starts from either 0 or 1,
depending on the value of <code>options(METIS_OPTION_NUMBERING)</code>.</p>
<p>Error code
<code>METIS_OK</code> - Indicates that the function returned normally.
<code>METIS_ERROR_INPUT</code> - Indicates an input error.
<code>METIS_ERROR_MEMORY</code> - Indicates that it could not allocate the required memory.
<code>METIS_ERROR</code> - Indicates some other type of error.</p>
<p>authors: Vikas Sharma, Ph. D.
date: 27 July 2021
summary: This function is used to partition a graph into <code>nparts</code> parts using multilevel k-way partitioning.</p>
<h3 id="introduction_3">Introduction</h3>
<p>This function is used to partition a graph into <code>nparts</code> parts using multilevel k-way partitioning.</p>
<p>THE FOLLOWING OPTIONS ARE VALID:
- <code>METIS_OPTION_OBJTYPE</code>
- <code>METIS_OPTION_CTYPE</code>
- <code>METIS_OPTION_IPTYPE</code>
- <code>METIS_OPTION_RTYPE</code>
- <code>METIS_OPTION_NO2HOP</code>
- <code>METIS_OPTION_NCUTS</code>
- <code>METIS_OPTION_NITER</code>
- <code>METIS_OPTION_UFACTOR</code>
- <code>METIS_OPTION_MINCONN</code>
- <code>METIS_OPTION_CONTIG</code>
- <code>METIS_OPTION_SEED</code>
- <code>METIS_OPTION_NUMBERING</code>
- <code>METIS_OPTION_DBGLVL</code></p>
<p>OPTIONAL :: VWGT, VSIZE, ADJWGT, TPWGTS, UBVEC, OPTIONS</p>
<p>int_METIS_PartGraphRecursive(idx_t <em>nvtxs, idx_t </em>ncon, idx_t <em>xadj, idx_t ! </em>adjncy, idx_t <em>vwgt, idx_t </em>vsize, idx_t <em>adjwgt, idx_t </em>nparts, real_t <em>tpwgts, real_t </em>ubvec, idx_t <em>options, idx_t </em>objval, idx_t *part)</p>
<p>The number of vertices in the graph.</p>
<p>The number of balancing constraints on each node.
It should be atleast 1.</p>
<p>The adjacency structure of the graph as described in
section 5.5 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The weights of the vertices as described in Section 5.5 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The size of the vertices for computing the total communication volume
as described in section 5.7 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The weights of the edges as describe in Section 5.5 of the
<a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>The number of parts to partition the graph.</p>
<p>This is an array pf size<code>nparts*ncon</code> that specifies the desired
weight for each partition and constraint.
The target partition weight for the ith partition and
jth constraint is specified at <code>tpwgts[i*ncon+j]</code>.
The numbering for both partition and constraints starts from 0.
For each constraint, the sum of the <code>tpwgts[]</code> entries must be 1.0.
If not present, the graph is divided equally among the partitions.
More in the description.</p>
<p>An array of size <code>ncon</code> that specifies the allowed load imbalance
for each constraint.
For the <code>i</code>-th partition and <code>j</code>-th constraint the allowed
weight is the <code>ubvec(j)*tpwgts(i*ncon+j)</code>
fraction of the <code>j</code>-th&rsquo;s constraint total weight.
If not present, the load imbalance
tolerance is 1.001 (for <code>ncon = 1</code>) or 1.01 (for <code>ncon &gt; 1</code>).</p>
<p>An array of options as described in Section 5.4 of the METIS manual.
See description for valid options.</p>
<p>Upon successful completion, this variable stores the edge-cut or the
total communication volume of the partitioning
solution. The value returned depends on the partitioning&rsquo;s objective
function.</p>
<p>This is a vector of size <code>nvtxs</code> that upon successful completion
stores the partition vector of the graph.
The numbering of this vector starts from either 0 or 1,
depending on the value of <code>options(METIS_OPTION_NUMBERING)</code>.</p>
<p>Error code
<code>METIS_OK</code> - Indicates that the function returned normally.
<code>METIS_ERROR_INPUT</code> - Indicates an input error.
<code>METIS_ERROR_MEMORY</code> - Indicates that it could not allocate the required memory.
<code>METIS_ERROR</code> - Indicates some other type of error.</p>
<p>authors: Vikas Sharma, Ph. D.
date: 27 July 2021
summary: This function is used to partition a mesh into <code>nparts</code> parts based on a partitioning of the mesh&rsquo;s dual graph.</p>
<h3 id="introduction_4">Introduction</h3>
<p>This function is used to partition a mesh into <code>nparts</code> parts based on a partitioning of the mesh&rsquo;s dual graph.</p>
<p>This program first converts the mesh into either a dual graph (i.e., each element becomes a graph vertex) or a nodal graph (i.e., each node becomes a graph vertex), and then uses the graph partitioning API routines to partition this graph. METIS utilizes a flexible approach for creating a graph for a finite element mesh, which allows it to handle meshes with different and possibly mixed element types (e.g., triangles, tetrahedra, hexahedra, etc.). The functionality provided by mpmetis is achieved by the METIS PartMeshNodal and METIS PartMeshDual API routines</p>
<p>THE FOLLOWING OPTIONS ARE VALID</p>
<ul>
<li><code>METIS_OPTION_PTYPE</code></li>
<li><code>METIS_OPTION_OBJTYPE</code></li>
<li><code>METIS_OPTION_CTYPE</code>,</li>
<li><code>METIS_OPTION_IPTYPE</code></li>
<li><code>METIS_OPTION_RTYPE</code></li>
<li><code>METIS_OPTION_NCUTS</code>,</li>
<li><code>METIS_OPTION_NITER</code></li>
<li><code>METIS_OPTION_SEED</code></li>
<li><code>METIS_OPTION_UFACTOR</code>,</li>
<li><code>METIS_OPTION_NUMBERING</code></li>
<li><code>METIS_OPTION_DBGLVL</code></li>
</ul>
<p>OPTIONAL : VWGT, VSIZE, TPWGTS, OPTIONS</p>
<p>MESH DATA STRUCTURE</p>
<p>All of the mesh partitioning and mesh conversion routines in METIS take as input the element node array of a mesh. This element node array is stored using a pair of arrays called eptr and eind, which are similar to the xadj and adjncy arrays used for storing the adjacency structure of a graph. The size of the eptr array is n+ 1, where n is the number of elements in the mesh. The size of the eind array is of size equal to the sum of the number of nodes in all the elements of the mesh. The list of nodes belonging to the ith element of the mesh are stored in consecutive locations of eind starting at position eptr[i] up to (but not including) position eptr[i+1]. This format makes it easy to specify meshes of any type of elements, including meshes with mixed element types that have different number of nodes per element. As it was the case with the format of the mesh file described in Section 4.1.2, the ordering of the nodes in each element is not important</p>
<p>The number of elements in the mesh.</p>
<p>The number of nodes in the mesh.</p>
<p>The pair of arrays storing the mesh as described in Section 5.6 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>An array of size <code>ne</code> specifying the weights of the elements. If not present, all elements have an equal weight.</p>
<p>An array of size <code>ne</code> specifying the size of the elements that is used
for computing the total comunication volume as described in Section 5.7 of the  <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.
If not present, the objective is cut or all elements have an equal size.</p>
<p>Specifies the number of common nodes that two elements must have in order to put an edge between them in the dual graph. Given two elements e1 and e2, containing n1 and n2 nodes, respectively, then an edge will connect the vertices in the dual graph corresponding to e1 and e2 if the number of common nodes between them is greater than or equal to min(ncommon; n1 − 1; n2 − 1). The default value is 1, indicating that two elements will be connected via an edge as long as they share one node. However, this will tend to create too many edges (increasing the memory and time requirements of the partitioning). The user should select higher values that are better suited for the element types of the mesh that wants to partition. For example, for tetrahedron meshes, ncommon should be 3, which creates an edge between two tets when they share a triangular face (i.e., 3 nodes)</p>
<p>The number of parts to partition the mesh.</p>
<p>An array of size <code>nparts</code> that specifies the desired weight for each partition. The <em>target partition weight</em> for the <code>i</code>-th partition is specified at <code>tpwgts(i)</code> (the numbering for the
partitions starts from 0). The sum of the <code>tpwgts</code> entries must be 1.0.
If not present, the graph is divided equally among the partitions.</p>
<p>An array of options as described in Section 5.4 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>. See description for valid options.</p>
<p>Upon successful completion, this variable stores either the edgecut or the total communication
volume of the dual graph&rsquo;s partitioning.</p>
<p>A vector of size <code>ne</code> that upon successful completion stores the partition vector for the elements
of the mesh. The numbering of this vector starts from either 0 or 1, depending on the value of
<code>options(METIS_OPTION_NUMBERING)</code>.</p>
<p>A vector of size <code>nn</code> that upon successful completion stores the partition vector for the nodes
of the mesh. The numbering of this vector starts from either 0 or 1, depending on the value of
<code>options(METIS_OPTION_NUMBERING)</code>.</p>
<p><code>METIS_OK</code> - Indicates that the function returned normally.<br />
<code>METIS_ERROR_INPUT</code> - Indicates an input error.<br />
<code>METIS_ERROR_MEMORY</code> - Indicates that it could not allocate the required memory.<br />
<code>METIS_ERROR</code> - Indicates some other type of error.</p>
<p>authors: Vikas Sharma, Ph. D.
date: 28 July 2021
summary: This function us used to partition a mesh into <code>nparts</code> parts based on a partitioning of the mesh&rsquo;s nodal graph.</p>
<h3 id="introduction_5">Introduction</h3>
<p>This function us used to partition a mesh into <code>nparts</code> parts based on a
partitioning of the mesh&rsquo;s nodal graph.</p>
<p>THE FOLLOWING OPTIONS ARE VALID:
- <code>METIS_OPTION_PTYPE</code>
- <code>METIS_OPTION_OBJTYPE</code>
- <code>METIS_OPTION_CTYPE</code>
- <code>METIS_OPTION_IPTYPE</code>
- <code>METIS_OPTION_RTYPE</code>
- <code>METIS_OPTION_NCUTS</code>,
- <code>METIS_OPTION_NITER</code>
- <code>METIS_OPTION_SEED</code>
- <code>METIS_OPTION_UFACTOR</code>,
- <code>METIS_OPTION_NUMBERING</code>
- <code>METIS_OPTION_DBGLVL</code></p>
<p>MESH DATA STRUCTURE</p>
<p>All of the mesh partitioning and mesh conversion routines in METIS take as input the element node array of a mesh. This element node array is stored using a pair of arrays called eptr and eind, which are similar to the xadj and adjncy arrays used for storing the adjacency structure of a graph. The size of the eptr array is n+ 1, where n is the number of elements in the mesh. The size of the eind array is of size equal to the sum of the number of nodes in all the elements of the mesh. The list of nodes belonging to the ith element of the mesh are stored in consecutive locations of eind starting at position eptr[i] up to (but not including) position eptr[i+1]. This format makes it easy to specify meshes of any type of elements, including meshes with mixed element types that have different number of nodes per element. As it was the case with the format of the mesh file described in Section 4.1.2, the ordering of the nodes in each element is not important</p>
<p>The number of elements in the mesh.</p>
<p>The number of nodes in the mesh.</p>
<p>The pair of arrays storing the mesh as described in Section 5.6 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>An array of size <code>nn</code> specifying weights of the nodes. If not passed, all nodes have an equal weight.</p>
<p>An array of size <code>nn</code> specifying the size of the nodes that is used for computing the
total comunication volume as described in Section 5.7 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>. If not passed,
the objective is cut or all nodes have an equal size.</p>
<p>The number of parts to partition the mesh.</p>
<p>An array of size <code>nparts</code> that specifies the desired weight for each partition. The <em>target
partition weight</em> for the <code>i</code>-th partition is specified at <code>tpwgts(i)</code> (the numbering for the
partitions starts from 0). The sum of the <code>tpwgts</code> entries must be 1.0. If not passed, the graph
is divided equally among the partitions.</p>
<p>An array of options as described in Section 5.4 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>. See description for valid options.</p>
<p>Upon successful completion, this variable stores either the edgecut or the total communication
volume of the nodal graph&rsquo;s partitioning.</p>
<p>A vector of size <code>ne</code> that upon successful completion stores the partition vector for the elements
of the mesh. The numbering of this vector starts from either 0 or 1, depending on the value of
<code>options(METIS_OPTION_NUMBERING)</code>.</p>
<p>A vector of size <code>nn</code> that upon successful completion stores the partition vector for the nodes
of the mesh. The numbering of this vector starts from either 0 or 1, depending on the value of
<code>options(METIS_OPTION_NUMBERING)</code>.</p>
<p><code>METIS_OK</code> - Indicates that the function returned normally.
<code>METIS_ERROR_INPUT</code> - Indicates an input error.
<code>METIS_ERROR_MEMORY</code> - Indicates that it could not allocate the required memory.
<code>METIS_ERROR</code> - Indicates some other type of error.</p>
<p>authors: Vikas Sharma, Ph. D.
date: 27 July 2021
summary:    This function is used to generate the dual graph of a mesh.</p>
<h3 id="introduction_6">Introduction</h3>
<p>This function is used to generate the dual graph of a mesh.</p>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>To use the returned arrays <code>xadj</code> and <code>adjncy</code>, these must be first converted from
a C pointer to a Fortran pointer using the subroutine <code>c_f_pointer(cptr,fptr,shape)</code>
that assigns the target of the C pointer <code>cptr</code> to the Fortran pointer <code>fptr</code> and
specifies its shape. The <code>shape</code> is an integer rank-one array, storing the size <code>ne+1</code>
in case of the dual graph. The size of the new <code>adjncy</code> array is stored in the
last element of <code>xadj</code> when using C-style numbering. An example is shown below.
</p></div>
<p>
<p></p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p>Memory for the returned arrays <code>xadj</code> and <code>adjncy</code> is allocated by METIS&rsquo; API in C
using the standard <code>malloc</code> function. It is the responsibility of the application to free
this memory by calling <code>free</code>. Therefore, METIS provides the <a href="../interface/metis_free.html">METIS_Free</a> function that is a wrapper to
C&rsquo;s <code>free</code>function.
</p></div>
<p>
<p>int METIS MeshToDual(idx t <em>ne, idx t </em>nn, idx t <em>eptr, idx t </em>eind, idx t <em>ncommon, idx t </em>numflag, idx t <strong>xadj, idx t </strong>adjncy)</p>
<p>The number of elements in the mesh.</p>
<p>The number of nodes in the mesh.</p>
<p>The pair of arrays storing the mesh as described in
Section 5.6 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>Specifies the number of common nodes that two elements must have in order to put an edge between them in the dual graph. Given two elements e1 and e2, containing n1 and n2 nodes, respectively, then an edge will connect the vertices in the dual graph corresponding to e1 and e2 if the number of common nodes between them is greater than or equal to min(ncommon; n1 − 1; n2 − 1). The default value is 1, indicating that two elements will be connected via an edge as long as they share one node. However, this will tend to create too many edges (increasing the memory and time requirements of the partitioning). The user should select higher values that are better suited for the element types of the mesh that wants to partition. For example, for tetrahedron meshes, ncommon should be 3, which creates an edge between two tets when they share a triangular face (i.e., 3 nodes)</p>
<p>Used to indicate which numbering scheme is used for <code>eptr</code> and <code>eind</code>.
The possible values are: <br />
0 - C-style numbering is assumed that starts from 0 <br />
1 - Fortran-style numbering is assumed that starts from 1</p>
<p>These arrays store the adjacency structure of the generated dual graph. The format of the adjacency structure is described in Section 5.5 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>. Memory for these arrays is allocated by METIS’ API using the standard malloc function. It is the responsibility of the application to free this memory by calling free. METIS provides the METIS Free that is a wrapper to C’s free function.</p>
<p><code>METIS_OK</code> - Indicates that the function returned normally.<br />
<code>METIS_ERROR_INPUT</code> - Indicates an input error.<br />
<code>METIS_ERROR_MEMORY</code> - Indicates that it could not allocate the required memory.<br />
<code>METIS_ERROR</code> - Indicates some other type of error.</p>
<p>authors: Vikas Sharma, Ph. D.
date: 27 July 2021
summary: This function is used to generate the nodal graph of a mesh.</p>
<h3 id="introduction_7">Introduction</h3>
<p>This function is used to generate the nodal graph of a mesh.</p>
<p></p><div class="alert alert-info" role="alert"><h4>Note</h4><p>To use the returned arrays <code>xadj</code> and <code>adjncy</code>, these must be first converted from
a C pointer to a Fortran pointer using the subroutine <code>c_f_pointer(cptr,fptr,shape)</code>
that assigns the target of the C pointer <code>cptr</code> to the Fortran pointer <code>fptr</code> and
specifies its shape. The <code>shape</code> is an integer rank-one array, storing the size <code>nn+1</code>
in case of the nodal graph. The size of the new <code>adjncy</code> array is stored in the
last element of <code>xadj</code> when using C-style numbering. An example is shown below.
</p></div>
<p>
<p></p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p>Memory for the returned arrays <code>xadj</code> and <code>adjncy</code> is allocated by METIS&rsquo; API in C
using the standard <code>malloc</code> function. It is the responsibility of the application to free
this memory by calling <code>free</code>. Therefore, METIS provides the <a href="../interface/metis_free.html">METIS_Free</a> function that is a wrapper to
C&rsquo;s <code>free</code>function.
</p></div>
<p>
<p>The number of elements in the mesh.</p>
<p>The number of nodes in the mesh.</p>
<p>The pair of arrays storing the mesh as described in Section 5.6 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>.</p>
<p>Used to indicate which numbering scheme is used for <code>eptr</code> and <code>eind</code>.
The possible values are:
0 - C-style numbering is assumed that starts from 0
1 - Fortran-style numbering is assumed that starts from 1</p>
<p>These arrays store the adjacency structure of the generated dual graph. The format of the adjacency structure is described in Section 5.5 of the <a href="http://glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf">manual</a>. Memory for these arrays is allocated by METIS’ API using the standard malloc function. It is the responsibility of the application to free this memory by calling free. METIS provides the METIS Free that is a wrapper to C’s free function.</p>
<p><code>METIS_OK</code> - Indicates that the function returned normally.
<code>METIS_ERROR_INPUT</code> - Indicates an input error.
<code>METIS_ERROR_MEMORY</code> - Indicates that it could not allocate the required memory.
<code>METIS_ERROR</code> - Indicates some other type of error.</p>
<p>Frees the memory that was allocated by either the <a href="../interface/metis_meshtodual.html">METIS_MeshToDual</a> or the
<a href="../interface/metis_meshtonodal.html">METIS_MeshToNodal</a> routines for returning the dual or nodal graph of a mesh.</p>
<p></p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p>Memory deallocation should always happen on the same side it was allocated!
Also check the descriptions of the above-mentioned routines.</p></div>
<h1 id="example">Example</h1>
<div class="codehilite"><pre><span></span><code><span class="k">type</span><span class="p">(</span><span class="kt">c_ptr</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xadj</span><span class="p">(:),</span><span class="n">adjncy</span><span class="p">(:)</span>

<span class="k">call </span><span class="n">METIS_MeshToNodal</span><span class="p">(...,</span><span class="n">xadj</span><span class="p">,</span><span class="n">adjncy</span><span class="p">)</span>

<span class="c">! xadj and adjncy should be deallocated on the C side! ;)</span>
<span class="k">call </span><span class="n">METIS_Free</span><span class="p">(</span><span class="n">xadj</span><span class="p">)</span>
<span class="k">call </span><span class="n">METIS_Free</span><span class="p">(</span><span class="n">adjncy</span><span class="p">)</span>
</code></pre></div>

<p>The pointer to be freed. This pointer should be one of the <code>xadj</code> or <code>adjncy</code>, arrays returned by METIS&rsquo; API routines</p>
<p><code>METIS_OK</code> Indicates that the function returned normally.</p>
      <br>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/metisinterface.inc.html#src">MetisInterface.inc</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1"></a><span class="err">!</span> <span class="n">This</span> <span class="n">program</span> <span class="n">is</span> <span class="n">a</span> <span class="n">part</span> <span class="n">of</span> <span class="n">EASIFEM</span> <span class="n">library</span>
<a id="ln-2" name="ln-2"></a><span class="err">!</span> <span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">2021</span>  <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span><span class="n">D</span>
<a id="ln-3" name="ln-3"></a><span class="err">!</span>
<a id="ln-4" name="ln-4"></a><span class="err">!</span> <span class="n">This</span> <span class="n">program</span> <span class="n">is</span> <span class="n">free</span> <span class="n">software</span><span class="err">:</span> <span class="n">you</span> <span class="n">can</span> <span class="n">redistribute</span> <span class="n">it</span> <span class="n">and</span><span class="o">/</span><span class="n">or</span> <span class="n">modify</span>
<a id="ln-5" name="ln-5"></a><span class="err">!</span> <span class="n">it</span> <span class="n">under</span> <span class="n">the</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">the</span> <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">as</span> <span class="n">published</span> <span class="n">by</span>
<a id="ln-6" name="ln-6"></a><span class="err">!</span> <span class="n">the</span> <span class="n">Free</span> <span class="n">Software</span> <span class="n">Foundation</span><span class="p">,</span> <span class="n">either</span> <span class="k">version</span> <span class="mi">3</span> <span class="n">of</span> <span class="n">the</span> <span class="n">License</span><span class="p">,</span> <span class="n">or</span>
<a id="ln-7" name="ln-7"></a><span class="err">!</span> <span class="p">(</span><span class="n">at</span> <span class="n">your</span> <span class="n">option</span><span class="p">)</span> <span class="n">any</span> <span class="n">later</span> <span class="k">version</span><span class="err">.</span>
<a id="ln-8" name="ln-8"></a><span class="err">!</span>
<a id="ln-9" name="ln-9"></a><span class="err">!</span> <span class="n">This</span> <span class="n">program</span> <span class="n">is</span> <span class="n">distributed</span> <span class="n">in</span> <span class="n">the</span> <span class="n">hope</span> <span class="n">that</span> <span class="n">it</span> <span class="n">will</span> <span class="n">be</span> <span class="n">useful</span><span class="p">,</span>
<a id="ln-10" name="ln-10"></a><span class="err">!</span> <span class="n">but</span> <span class="n">WITHOUT</span> <span class="n">ANY</span> <span class="n">WARRANTY</span><span class="p">;</span> <span class="n">without</span> <span class="n">even</span> <span class="n">the</span> <span class="n">implied</span> <span class="n">warranty</span> <span class="n">of</span>
<a id="ln-11" name="ln-11"></a><span class="err">!</span> <span class="n">MERCHANTABILITY</span> <span class="n">or</span> <span class="n">FITNESS</span> <span class="n">FOR</span> <span class="n">A</span> <span class="n">PARTICULAR</span> <span class="n">PURPOSE</span><span class="err">.</span>  <span class="n">See</span> <span class="n">the</span>
<a id="ln-12" name="ln-12"></a><span class="err">!</span> <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span> <span class="n">for</span> <span class="n">more</span> <span class="n">details</span><span class="err">.</span>
<a id="ln-13" name="ln-13"></a><span class="err">!</span>
<a id="ln-14" name="ln-14"></a><span class="err">!</span> <span class="n">You</span> <span class="n">should</span> <span class="n">have</span> <span class="n">received</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">the</span> <span class="n">GNU</span> <span class="n">General</span> <span class="n">Public</span> <span class="n">License</span>
<a id="ln-15" name="ln-15"></a><span class="err">!</span> <span class="n">along</span> <span class="n">with</span> <span class="n">this</span> <span class="n">program</span><span class="err">.</span>  <span class="n">If</span> <span class="n">not</span><span class="p">,</span> <span class="n">see</span> <span class="p">&lt;</span><span class="n">https</span><span class="err">:</span> <span class="c1">//www.gnu.org/licenses/&gt;</span>
<a id="ln-16" name="ln-16"></a>
<a id="ln-17" name="ln-17"></a><span class="cp">#define</span> <span class="n">_I_OUT_</span> <span class="n">INTEGER</span><span class="p">(</span> <span class="n">C_INT</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">OUT</span> <span class="p">)</span>
<a id="ln-18" name="ln-18"></a><span class="cp">#define</span> <span class="n">_I_IN_</span> <span class="n">INTEGER</span><span class="p">(</span> <span class="n">C_INT</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-19" name="ln-19"></a><span class="cp">#define</span> <span class="n">_I_V_IN_</span> <span class="n">INTEGER</span><span class="p">(</span> <span class="n">C_INT</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-20" name="ln-20"></a><span class="cp">#define</span> <span class="n">_ST_V_IN_</span> <span class="n">INTEGER</span><span class="p">(</span> <span class="n">C_SIZE_T</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-21" name="ln-21"></a><span class="cp">#define</span> <span class="n">_ST_OUT_</span> <span class="n">INTEGER</span><span class="p">(</span> <span class="n">C_SIZE_T</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">OUT</span> <span class="p">)</span>
<a id="ln-22" name="ln-22"></a><span class="cp">#define</span> <span class="n">_ST_IN_</span> <span class="n">INTEGER</span><span class="p">(</span> <span class="n">C_SIZE_T</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-23" name="ln-23"></a><span class="cp">#define</span> <span class="n">_R_V_IN_</span> <span class="n">REAL</span><span class="p">(</span> <span class="n">C_DOUBLE</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-24" name="ln-24"></a><span class="cp">#define</span> <span class="n">_R_IN_</span> <span class="n">REAL</span><span class="p">(</span> <span class="n">C_DOUBLE</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-25" name="ln-25"></a><span class="cp">#define</span> <span class="n">_R_OUT_</span> <span class="n">REAL</span><span class="p">(</span> <span class="n">C_DOUBLE</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">OUT</span> <span class="p">)</span>
<a id="ln-26" name="ln-26"></a><span class="cp">#define</span> <span class="n">_CPTR_V_IN_</span> <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-27" name="ln-27"></a><span class="cp">#define</span> <span class="n">_CPTR_IN_</span> <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span>
<a id="ln-28" name="ln-28"></a>
<a id="ln-29" name="ln-29"></a>
<a id="ln-30" name="ln-30"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">MAX_METIS_OPTIONS</span> <span class="o">=</span> <span class="mi">40</span>
<a id="ln-31" name="ln-31"></a>  <span class="err">!!</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">METSI</span> <span class="n">OPTIONS</span>
<a id="ln-32" name="ln-32"></a>
<a id="ln-33" name="ln-33"></a><span class="err">!</span> <span class="n">Return</span> <span class="n">codes</span>
<a id="ln-34" name="ln-34"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OK</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-35" name="ln-35"></a>  <span class="err">!!</span> <span class="n">Flag</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">that</span> <span class="n">there</span> <span class="n">is</span> <span class="k">no</span> <span class="k">error</span>
<a id="ln-36" name="ln-36"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_ERROR_INPUT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<a id="ln-37" name="ln-37"></a>  <span class="err">!!</span> <span class="n">Flag</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">that</span> <span class="n">there</span> <span class="n">is</span> <span class="n">erro</span> <span class="n">during</span> <span class="n">input</span> <span class="n">output</span>
<a id="ln-38" name="ln-38"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_ERROR_MEMORY</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<a id="ln-39" name="ln-39"></a>  <span class="err">!!</span> <span class="n">Flag</span> <span class="n">to</span> <span class="n">indicate</span> <span class="k">error</span> <span class="n">due</span> <span class="n">to</span> <span class="n">the</span> <span class="n">insufficient</span> <span class="n">memory</span><span class="err">.</span>
<a id="ln-40" name="ln-40"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_ERROR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<a id="ln-41" name="ln-41"></a>  <span class="err">!!</span> <span class="n">Flag</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">undocumented</span> <span class="k">error</span>
<a id="ln-42" name="ln-42"></a>
<a id="ln-43" name="ln-43"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-44" name="ln-44"></a><span class="err">!</span>
<a id="ln-45" name="ln-45"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-46" name="ln-46"></a>
<a id="ln-47" name="ln-47"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_PTYPE</span> <span class="o">=</span> <span class="mi">0</span>
<a id="ln-48" name="ln-48"></a>  <span class="err">!!</span> <span class="n">It</span> <span class="n">specifies</span> <span class="n">the</span> <span class="k">type</span> <span class="n">of</span> <span class="n">partitioning</span> <span class="n">method</span><span class="p">;</span> <span class="n">The</span> <span class="n">possible</span> <span class="n">values</span> <span class="n">are</span>
<a id="ln-49" name="ln-49"></a>  <span class="err">!!</span> <span class="n">given</span> <span class="n">below</span><span class="err">.</span>
<a id="ln-50" name="ln-50"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PTYPE_RB</span>   <span class="o">=</span> <span class="mi">0</span>
<a id="ln-51" name="ln-51"></a>  <span class="err">!!</span> <span class="n">Multilevel</span> <span class="n">recursive</span> <span class="n">bisectioning</span><span class="err">.</span>
<a id="ln-52" name="ln-52"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PTYPE_KWAY</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-53" name="ln-53"></a>  <span class="err">!!</span> <span class="n">Multilevel</span> <span class="n">k</span><span class="o">-</span><span class="n">way</span> <span class="n">partitioning</span><span class="err">.</span> <span class="n">DEFAULT</span>
<a id="ln-54" name="ln-54"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PTYPE_DEFAULT</span> <span class="o">=</span> <span class="n">METIS_PTYPE_KWAY</span>
<a id="ln-55" name="ln-55"></a>  <span class="err">!!</span> <span class="n">Default</span> <span class="n">value</span> <span class="n">of</span> <span class="n">METIS_OPTION_PTYPE</span>
<a id="ln-56" name="ln-56"></a>
<a id="ln-57" name="ln-57"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-58" name="ln-58"></a><span class="err">!</span>
<a id="ln-59" name="ln-59"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-60" name="ln-60"></a>
<a id="ln-61" name="ln-61"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_OBJTYPE</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-62" name="ln-62"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">objective</span> <span class="k">type</span><span class="p">,</span> <span class="n">two</span> <span class="n">values</span> <span class="n">are</span> <span class="n">possible</span><span class="err">:</span> <span class="n">Edge</span><span class="o">-</span><span class="n">cut</span><span class="p">,</span> <span class="n">which</span>
<a id="ln-63" name="ln-63"></a>  <span class="err">!!</span> <span class="n">minimizes</span> <span class="n">the</span> <span class="n">communication</span> <span class="n">time</span><span class="p">,</span> <span class="n">and</span> <span class="n">Total</span> <span class="n">communication</span> <span class="n">volume</span>
<a id="ln-64" name="ln-64"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OBJTYPE_CUT</span>  <span class="o">=</span> <span class="mi">0</span>
<a id="ln-65" name="ln-65"></a>  <span class="err">!!</span> <span class="n">Edge</span><span class="o">-</span><span class="n">cut</span> <span class="n">minimization</span><span class="err">.</span>
<a id="ln-66" name="ln-66"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OBJTYPE_VOL</span>  <span class="o">=</span> <span class="mi">1</span>
<a id="ln-67" name="ln-67"></a>  <span class="err">!!</span> <span class="n">Total</span> <span class="n">communication</span> <span class="n">volume</span> <span class="n">minimization</span><span class="err">.</span>
<a id="ln-68" name="ln-68"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OBJTYPE_NODE</span> <span class="o">=</span> <span class="mi">2</span>
<a id="ln-69" name="ln-69"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OBJTYPE_DEFAULT</span> <span class="o">=</span> <span class="n">METIS_OBJTYPE_CUT</span>
<a id="ln-70" name="ln-70"></a>
<a id="ln-71" name="ln-71"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-72" name="ln-72"></a><span class="err">!</span>
<a id="ln-73" name="ln-73"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-74" name="ln-74"></a>
<a id="ln-75" name="ln-75"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_CTYPE</span> <span class="o">=</span> <span class="mi">2</span>
<a id="ln-76" name="ln-76"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">matching</span> <span class="n">scheme</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">during</span> <span class="n">coarsening</span><span class="err">.</span> <span class="n">Possible</span>
<a id="ln-77" name="ln-77"></a>  <span class="err">!!</span> <span class="n">values</span> <span class="n">are</span> <span class="n">as</span> <span class="n">follows</span><span class="err">:</span>
<a id="ln-78" name="ln-78"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_CTYPE_RM</span>   <span class="o">=</span> <span class="mi">0</span>
<a id="ln-79" name="ln-79"></a>  <span class="err">!!</span> <span class="n">Random</span> <span class="n">matching</span><span class="err">.</span>
<a id="ln-80" name="ln-80"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_CTYPE_SHEM</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-81" name="ln-81"></a>  <span class="err">!!</span> <span class="n">Sorted</span> <span class="n">heavy</span><span class="o">-</span><span class="n">edge</span> <span class="n">matching</span><span class="err">.</span>
<a id="ln-82" name="ln-82"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_CTYPE_DEFAULT</span><span class="o">=</span><span class="n">METIS_CTYPE_RM</span>
<a id="ln-83" name="ln-83"></a>
<a id="ln-84" name="ln-84"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-85" name="ln-85"></a><span class="err">!</span>
<a id="ln-86" name="ln-86"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-87" name="ln-87"></a>
<a id="ln-88" name="ln-88"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_IPTYPE</span> <span class="o">=</span> <span class="mi">3</span>
<a id="ln-89" name="ln-89"></a>  <span class="err">!!</span> <span class="n">Specify</span> <span class="n">the</span> <span class="n">algorithm</span> <span class="n">used</span> <span class="n">during</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">partitioning</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span>
<a id="ln-90" name="ln-90"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_IPTYPE_GROW</span>    <span class="o">=</span> <span class="mi">0</span>
<a id="ln-91" name="ln-91"></a>  <span class="err">!!</span> <span class="n">grows</span> <span class="n">bisection</span> <span class="n">using</span> <span class="n">a</span> <span class="n">greedy</span> <span class="n">strategy</span><span class="err">.</span>
<a id="ln-92" name="ln-92"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_IPTYPE_RANDOM</span>  <span class="o">=</span> <span class="mi">1</span>
<a id="ln-93" name="ln-93"></a>  <span class="err">!!</span> <span class="n">computes</span> <span class="n">bisection</span> <span class="n">at</span> <span class="n">random</span> <span class="n">followed</span> <span class="n">by</span> <span class="n">a</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-94" name="ln-94"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_IPTYPE_EDGE</span>    <span class="o">=</span> <span class="mi">2</span>
<a id="ln-95" name="ln-95"></a>  <span class="err">!!</span> <span class="n">derives</span> <span class="n">separator</span> <span class="n">form</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">cut</span><span class="err">.</span>
<a id="ln-96" name="ln-96"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_IPTYPE_NODE</span>    <span class="o">=</span> <span class="mi">3</span>
<a id="ln-97" name="ln-97"></a>  <span class="err">!!</span> <span class="n">grows</span> <span class="n">bisection</span> <span class="n">using</span> <span class="n">a</span> <span class="n">greedy</span> <span class="n">node</span><span class="o">-</span><span class="n">based</span> <span class="n">strategy</span><span class="err">.</span>
<a id="ln-98" name="ln-98"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_IPTYPE_METISRB</span> <span class="o">=</span> <span class="mi">4</span>
<a id="ln-99" name="ln-99"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_IPTYPE_DEFAULT</span><span class="o">=</span><span class="n">METIS_IPTYPE_GROW</span>
<a id="ln-100" name="ln-100"></a>
<a id="ln-101" name="ln-101"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-102" name="ln-102"></a><span class="err">!</span>
<a id="ln-103" name="ln-103"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-104" name="ln-104"></a>
<a id="ln-105" name="ln-105"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_RTYPE</span> <span class="o">=</span> <span class="mi">4</span>
<a id="ln-106" name="ln-106"></a>  <span class="err">!!</span> <span class="n">Specify</span> <span class="n">the</span> <span class="n">algorithm</span> <span class="n">used</span> <span class="n">for</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-107" name="ln-107"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_RTYPE_FM</span>        <span class="o">=</span> <span class="mi">0</span>
<a id="ln-108" name="ln-108"></a>  <span class="err">!!</span> <span class="n">FM</span><span class="o">-</span><span class="n">basecut</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-109" name="ln-109"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_RTYPE_GREEDY</span>    <span class="o">=</span> <span class="mi">1</span>
<a id="ln-110" name="ln-110"></a>  <span class="err">!!</span><span class="n">Greedy</span><span class="o">-</span><span class="n">based</span> <span class="n">cut</span> <span class="n">and</span> <span class="n">volume</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-111" name="ln-111"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_RTYPE_SEP2SIDED</span> <span class="o">=</span> <span class="mi">2</span>
<a id="ln-112" name="ln-112"></a>  <span class="err">!!</span> <span class="n">Two</span><span class="o">-</span><span class="n">sidenode</span> <span class="n">FM</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-113" name="ln-113"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_RTYPE_SEP1SIDED</span> <span class="o">=</span> <span class="mi">3</span>
<a id="ln-114" name="ln-114"></a>  <span class="err">!!</span> <span class="n">One</span><span class="o">-</span><span class="n">sidenode</span> <span class="n">FM</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-115" name="ln-115"></a>
<a id="ln-116" name="ln-116"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-117" name="ln-117"></a><span class="err">!</span>
<a id="ln-118" name="ln-118"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-119" name="ln-119"></a>
<a id="ln-120" name="ln-120"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_DBGLVL</span> <span class="o">=</span> <span class="mi">5</span>
<a id="ln-121" name="ln-121"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">progress</span><span class="o">/</span><span class="n">debugging</span> <span class="n">information</span> <span class="n">will</span> <span class="n">be</span> <span class="n">printed</span> <span class="n">during</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">of</span> <span class="n">the</span> <span class="n">algorithms</span><span class="err">.</span> <span class="n">The</span> <span class="k">default</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">0</span> <span class="p">(</span><span class="k">no</span> <span class="n">debugging</span><span class="o">/</span><span class="n">progress</span> <span class="n">information</span><span class="p">)</span><span class="err">.</span> <span class="n">A</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="n">value</span> <span class="n">can</span> <span class="n">be</span> <span class="n">supplied</span> <span class="n">that</span> <span class="n">is</span> <span class="n">obtained</span> <span class="n">by</span> <span class="n">a</span> <span class="n">bit</span><span class="o">-</span><span class="n">wise</span> <span class="n">OR</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">values</span>
<a id="ln-122" name="ln-122"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_INFO</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-123" name="ln-123"></a>  <span class="err">!!</span> <span class="n">Shows</span> <span class="n">various</span> <span class="n">diagnostic</span> <span class="n">messages</span><span class="err">.</span>
<a id="ln-124" name="ln-124"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_TIME</span> <span class="o">=</span> <span class="mi">2</span>
<a id="ln-125" name="ln-125"></a>  <span class="err">!!</span> <span class="n">Perform</span> <span class="n">timing</span> <span class="n">analysis</span><span class="err">.</span>
<a id="ln-126" name="ln-126"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_COARSEN</span> <span class="o">=</span> <span class="mi">4</span>
<a id="ln-127" name="ln-127"></a>  <span class="err">!!</span> <span class="n">Shothe</span> <span class="n">coarsening</span> <span class="n">progress</span><span class="err">.</span>
<a id="ln-128" name="ln-128"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_REFINE</span> <span class="o">=</span> <span class="mi">8</span>
<a id="ln-129" name="ln-129"></a>  <span class="err">!!</span> <span class="n">Shothe</span> <span class="n">refinement</span> <span class="n">progress</span><span class="err">.</span>
<a id="ln-130" name="ln-130"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_IPART</span> <span class="o">=</span> <span class="mi">16</span>
<a id="ln-131" name="ln-131"></a>  <span class="err">!!</span> <span class="n">Shoinfo</span> <span class="k">on</span> <span class="n">initial</span> <span class="n">partitioning</span><span class="err">.</span>
<a id="ln-132" name="ln-132"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_MOVEINFO</span> <span class="o">=</span> <span class="mi">32</span>
<a id="ln-133" name="ln-133"></a>  <span class="err">!!</span> <span class="n">Shoinfo</span> <span class="k">on</span> <span class="n">vertex</span> <span class="n">moves</span> <span class="n">during</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-134" name="ln-134"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_SEPINFO</span> <span class="o">=</span> <span class="mi">64</span>
<a id="ln-135" name="ln-135"></a>  <span class="err">!!</span> <span class="n">Shoinfo</span> <span class="k">on</span> <span class="n">vertex</span> <span class="n">moves</span> <span class="n">during</span> <span class="n">sep</span> <span class="n">refinement</span><span class="err">.</span>
<a id="ln-136" name="ln-136"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_CONNINFO</span> <span class="o">=</span> <span class="mi">128</span>
<a id="ln-137" name="ln-137"></a>  <span class="err">!!</span> <span class="n">Shoinfo</span> <span class="k">on</span> <span class="n">minimization</span> <span class="n">of</span> <span class="n">subdomain</span> <span class="n">connectivity</span><span class="err">.</span>
<a id="ln-138" name="ln-138"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_CONTIGINFO</span> <span class="o">=</span> <span class="mi">256</span>
<a id="ln-139" name="ln-139"></a>  <span class="err">!!</span> <span class="n">Shoinfo</span> <span class="k">on</span> <span class="n">elimination</span> <span class="n">of</span> <span class="n">connected</span> <span class="n">components</span><span class="err">.</span>
<a id="ln-140" name="ln-140"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_DBG_MEMORY</span> <span class="o">=</span> <span class="mi">2048</span>
<a id="ln-141" name="ln-141"></a>  <span class="err">!!</span> <span class="n">Shoinfo</span> <span class="n">related</span> <span class="n">to</span> <span class="n">wspace</span> <span class="n">allocation</span><span class="err">.</span>
<a id="ln-142" name="ln-142"></a>
<a id="ln-143" name="ln-143"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-144" name="ln-144"></a><span class="err">!</span>
<a id="ln-145" name="ln-145"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-146" name="ln-146"></a>
<a id="ln-147" name="ln-147"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_NITER</span> <span class="o">=</span> <span class="mi">6</span>
<a id="ln-148" name="ln-148"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span> <span class="n">for</span> <span class="n">the</span> <span class="n">refinement</span> <span class="n">algorithm</span><span class="err">.</span>
<a id="ln-149" name="ln-149"></a>  <span class="err">!!</span> <span class="n">Default</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">10</span>
<a id="ln-150" name="ln-150"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_NITER_DEFAULT</span> <span class="o">=</span> <span class="mi">10</span>
<a id="ln-151" name="ln-151"></a>
<a id="ln-152" name="ln-152"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-153" name="ln-153"></a><span class="err">!</span>
<a id="ln-154" name="ln-154"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-155" name="ln-155"></a>
<a id="ln-156" name="ln-156"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_NCUTS</span> <span class="o">=</span> <span class="mi">7</span>
<a id="ln-157" name="ln-157"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">different</span> <span class="n">partitionings</span> <span class="n">that</span> <span class="n">it</span> <span class="n">will</span> <span class="n">compute</span><span class="err">.</span> <span class="n">The</span> <span class="n">final</span> <span class="n">partitioning</span> <span class="n">is</span> <span class="n">the</span> <span class="n">one</span> <span class="n">that</span> <span class="n">achieves</span> <span class="n">the</span> <span class="n">best</span> <span class="n">edgecut</span> <span class="n">or</span> <span class="n">communication</span> <span class="n">volume</span><span class="err">.</span> <span class="n">Default</span> <span class="n">is</span> <span class="mi">1</span>
<a id="ln-158" name="ln-158"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_NCUTS_DEFAULT</span><span class="o">=</span><span class="mi">1</span>
<a id="ln-159" name="ln-159"></a>
<a id="ln-160" name="ln-160"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-161" name="ln-161"></a><span class="err">!</span>
<a id="ln-162" name="ln-162"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-163" name="ln-163"></a>
<a id="ln-164" name="ln-164"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_SEED</span> <span class="o">=</span> <span class="mi">8</span>
<a id="ln-165" name="ln-165"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="k">seed</span> <span class="n">for</span> <span class="n">the</span> <span class="n">random</span> <span class="n">number</span> <span class="n">generator</span><span class="err">.</span>
<a id="ln-166" name="ln-166"></a>
<a id="ln-167" name="ln-167"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-168" name="ln-168"></a><span class="err">!</span>
<a id="ln-169" name="ln-169"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-170" name="ln-170"></a>
<a id="ln-171" name="ln-171"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_NO2HOP</span> <span class="o">=</span> <span class="mi">9</span>
<a id="ln-172" name="ln-172"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">that</span> <span class="n">the</span> <span class="n">coarsening</span> <span class="n">will</span> <span class="n">not</span> <span class="n">perform</span> <span class="n">any</span> <span class="mi">2</span><span class="err">–</span><span class="n">hop</span> <span class="n">matchings</span> <span class="n">when</span> <span class="n">the</span> <span class="n">standard</span> <span class="n">matching</span> <span class="n">approach</span> <span class="n">fails</span> <span class="n">to</span> <span class="n">sufficiently</span> <span class="n">coarsen</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span> <span class="n">The</span> <span class="mi">2</span><span class="err">–</span><span class="n">hop</span> <span class="n">matching</span> <span class="n">is</span> <span class="n">very</span> <span class="n">effective</span> <span class="n">for</span> <span class="n">graphs</span> <span class="n">with</span> <span class="n">power</span><span class="o">-</span><span class="n">law</span> <span class="n">degree</span> <span class="n">distributions</span><span class="err">.</span>
<a id="ln-173" name="ln-173"></a>  <span class="err">!!</span> <span class="o">-</span> <span class="mi">0</span> <span class="n">means</span> <span class="n">perform</span> <span class="mi">2</span><span class="o">-</span><span class="n">hop</span> <span class="n">matching</span>
<a id="ln-174" name="ln-174"></a>  <span class="err">!!</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">means</span> <span class="n">do</span> <span class="n">not</span> <span class="n">perform</span> <span class="mi">2</span><span class="o">-</span><span class="n">hop</span> <span class="n">matching</span>
<a id="ln-175" name="ln-175"></a>
<a id="ln-176" name="ln-176"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-177" name="ln-177"></a><span class="err">!</span>
<a id="ln-178" name="ln-178"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-179" name="ln-179"></a>
<a id="ln-180" name="ln-180"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_MINCONN</span>   <span class="o">=</span> <span class="mi">10</span>
<a id="ln-181" name="ln-181"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">that</span> <span class="n">the</span> <span class="n">partitioning</span> <span class="n">routines</span> <span class="n">should</span> <span class="n">try</span> <span class="n">to</span> <span class="n">minimize</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">degree</span> <span class="n">of</span> <span class="n">the</span> <span class="n">subdomain</span> <span class="n">graph</span><span class="p">,</span> <span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">in</span> <span class="n">which</span> <span class="n">each</span> <span class="n">partition</span> <span class="n">is</span> <span class="n">a</span> <span class="n">node</span><span class="p">,</span> <span class="n">and</span> <span class="n">edges</span> <span class="n">connect</span> <span class="n">subdomains</span> <span class="n">with</span> <span class="n">a</span> <span class="n">shared</span> <span class="n">interface</span><span class="err">.</span>
<a id="ln-182" name="ln-182"></a>  <span class="err">!!</span> <span class="mi">0</span> <span class="n">Does</span> <span class="n">not</span> <span class="n">explicitly</span> <span class="n">minimize</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">connectivity</span>
<a id="ln-183" name="ln-183"></a>  <span class="err">!!</span> <span class="mi">1</span> <span class="n">explicitly</span> <span class="n">minimize</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">connectivity</span>
<a id="ln-184" name="ln-184"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_MINCONN_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
<a id="ln-185" name="ln-185"></a>
<a id="ln-186" name="ln-186"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-187" name="ln-187"></a><span class="err">!</span>
<a id="ln-188" name="ln-188"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-189" name="ln-189"></a>
<a id="ln-190" name="ln-190"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_CONTIG</span> <span class="o">=</span> <span class="mi">11</span>
<a id="ln-191" name="ln-191"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">that</span> <span class="n">the</span> <span class="n">partitioning</span> <span class="n">routines</span> <span class="n">should</span> <span class="n">try</span> <span class="n">to</span> <span class="n">produce</span> <span class="n">partitionsthat</span> <span class="n">are</span> <span class="n">contigous</span><span class="err">.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">input</span> <span class="n">graph</span> <span class="n">is</span> <span class="n">not</span> <span class="n">connected</span> <span class="n">then</span> <span class="n">this</span> <span class="n">option</span> <span class="n">is</span> <span class="n">ignored</span>
<a id="ln-192" name="ln-192"></a>  <span class="err">!!</span> <span class="o">-</span> <span class="mi">0</span> <span class="n">does</span> <span class="n">not</span> <span class="n">force</span> <span class="n">contiguous</span> <span class="n">partition</span>
<a id="ln-193" name="ln-193"></a>  <span class="err">!!</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">does</span> <span class="n">force</span> <span class="n">contingous</span> <span class="n">partition</span>
<a id="ln-194" name="ln-194"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_CONTIG_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
<a id="ln-195" name="ln-195"></a>
<a id="ln-196" name="ln-196"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-197" name="ln-197"></a><span class="err">!</span>
<a id="ln-198" name="ln-198"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-199" name="ln-199"></a>
<a id="ln-200" name="ln-200"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_COMPRESS</span> <span class="o">=</span> <span class="mi">12</span>
<a id="ln-201" name="ln-201"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_COMPRESS_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
<a id="ln-202" name="ln-202"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">that</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">should</span> <span class="n">be</span> <span class="n">compressed</span> <span class="n">by</span> <span class="n">combining</span> <span class="n">togethervertices</span> <span class="n">that</span> <span class="n">have</span> <span class="n">identical</span> <span class="n">adjacency</span> <span class="n">lists</span><span class="err">.</span>
<a id="ln-203" name="ln-203"></a>  <span class="err">!!</span> <span class="n">O</span><span class="o">-</span> <span class="n">does</span> <span class="n">not</span> <span class="n">compress</span>
<a id="ln-204" name="ln-204"></a>  <span class="err">!!</span> <span class="mi">1</span> <span class="n">compress</span>
<a id="ln-205" name="ln-205"></a>
<a id="ln-206" name="ln-206"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-207" name="ln-207"></a><span class="err">!</span>
<a id="ln-208" name="ln-208"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-209" name="ln-209"></a>
<a id="ln-210" name="ln-210"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_CCORDER</span> <span class="o">=</span> <span class="mi">13</span>
<a id="ln-211" name="ln-211"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_CCORDER_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
<a id="ln-212" name="ln-212"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="k">if</span> <span class="n">the</span> <span class="n">connected</span> <span class="n">components</span> <span class="n">of</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">should</span> <span class="n">first</span> <span class="n">be</span> <span class="n">identifies</span> <span class="n">and</span> <span class="n">ordered</span> <span class="n">separately</span><span class="err">.</span>
<a id="ln-213" name="ln-213"></a>
<a id="ln-214" name="ln-214"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-215" name="ln-215"></a><span class="err">!</span>
<a id="ln-216" name="ln-216"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-217" name="ln-217"></a>
<a id="ln-218" name="ln-218"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_PFACTOR</span> <span class="o">=</span> <span class="mi">14</span>
<a id="ln-219" name="ln-219"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PFACTOR_DEFAULT</span> <span class="o">=</span> <span class="mi">0</span>
<a id="ln-220" name="ln-220"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">minimum</span> <span class="n">degree</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">ordered</span> <span class="n">last</span><span class="err">.</span>
<a id="ln-221" name="ln-221"></a>  <span class="err">!!</span> <span class="n">If</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">value</span> <span class="n">is</span> <span class="bp">x</span> <span class="p">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">then</span>
<a id="ln-222" name="ln-222"></a>  <span class="err">!!</span> <span class="n">any</span> <span class="n">vertices</span> <span class="n">with</span> <span class="n">a</span> <span class="n">degree</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">0.1</span><span class="o">*</span><span class="bp">x</span><span class="o">*</span><span class="p">(</span><span class="k">average</span> <span class="n">degree</span><span class="p">)</span> <span class="n">are</span> <span class="n">removed</span> <span class="n">from</span> <span class="n">the</span> <span class="n">graph</span><span class="p">,</span> <span class="n">an</span> <span class="n">ordering</span> <span class="n">of</span>
<a id="ln-223" name="ln-223"></a>  <span class="err">!!</span> <span class="n">the</span> <span class="n">rest</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">is</span> <span class="n">computed</span><span class="p">,</span> <span class="n">and</span> <span class="n">an</span> <span class="n">overall</span> <span class="n">ordering</span> <span class="n">is</span> <span class="n">computed</span> <span class="n">by</span> <span class="n">ordering</span> <span class="n">the</span> <span class="n">removed</span> <span class="n">vertices</span>
<a id="ln-224" name="ln-224"></a>  <span class="err">!!</span> <span class="n">at</span> <span class="n">the</span> <span class="k">end</span> <span class="n">of</span> <span class="n">the</span> <span class="n">overall</span> <span class="n">ordering</span><span class="err">.</span> <span class="n">For</span> <span class="n">example</span> <span class="k">if</span> <span class="bp">x</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">and</span> <span class="n">the</span> <span class="k">average</span> <span class="n">degree</span> <span class="n">is</span> <span class="mi">5</span><span class="p">,</span> <span class="n">then</span> <span class="n">the</span> <span class="n">algorithm</span>
<a id="ln-225" name="ln-225"></a>  <span class="err">!!</span> <span class="n">will</span> <span class="n">remove</span> <span class="k">all</span> <span class="n">vertices</span> <span class="n">with</span> <span class="n">degree</span> <span class="n">greater</span> <span class="n">than</span> <span class="mf">20.</span> <span class="n">The</span> <span class="n">vertices</span> <span class="n">that</span> <span class="n">are</span> <span class="n">removed</span> <span class="n">are</span> <span class="n">ordered</span> <span class="n">last</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span>
<a id="ln-226" name="ln-226"></a>  <span class="err">!!</span> <span class="n">they</span> <span class="n">are</span> <span class="n">automatically</span> <span class="n">placed</span> <span class="n">in</span> <span class="n">the</span> <span class="n">top</span><span class="o">-</span><span class="n">level</span> <span class="n">separator</span><span class="p">)</span><span class="err">.</span> <span class="n">Good</span> <span class="n">values</span> <span class="n">are</span> <span class="n">often</span> <span class="n">in</span> <span class="n">the</span> <span class="k">range</span> <span class="n">of</span> <span class="mi">60</span> <span class="n">to</span> <span class="mi">200</span>
<a id="ln-227" name="ln-227"></a>  <span class="err">!!</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span> <span class="mi">6</span> <span class="n">to</span> <span class="mi">20</span> <span class="n">times</span> <span class="n">more</span> <span class="n">than</span> <span class="n">the</span> <span class="k">average</span><span class="p">)</span><span class="err">.</span> <span class="n">Default</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">0</span><span class="p">,</span> <span class="n">indicating</span> <span class="n">that</span> <span class="k">no</span> <span class="n">vertices</span> <span class="n">are</span> <span class="n">removed</span><span class="err">.</span>
<a id="ln-228" name="ln-228"></a>  <span class="err">!!</span> <span class="n">Used</span> <span class="n">to</span> <span class="n">control</span> <span class="n">whether</span> <span class="n">or</span> <span class="n">not</span> <span class="n">the</span> <span class="n">ordering</span> <span class="n">algorithm</span> <span class="n">should</span> <span class="n">remove</span> <span class="n">any</span> <span class="n">vertices</span> <span class="n">with</span> <span class="n">high</span> <span class="n">degree</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span>
<a id="ln-229" name="ln-229"></a>  <span class="err">!!</span> <span class="n">dense</span> <span class="n">columns</span><span class="p">)</span><span class="err">.</span> <span class="n">This</span> <span class="n">is</span> <span class="n">particularly</span> <span class="n">helpful</span> <span class="n">for</span> <span class="n">certain</span> <span class="n">classes</span> <span class="n">of</span> <span class="n">LP</span> <span class="n">matrices</span><span class="p">,</span> <span class="n">in</span> <span class="n">which</span> <span class="n">there</span> <span class="n">a</span> <span class="n">few</span> <span class="n">vertices</span>
<a id="ln-230" name="ln-230"></a>  <span class="err">!!</span> <span class="n">that</span> <span class="n">are</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">many</span> <span class="n">other</span> <span class="n">vertices</span><span class="err">.</span> <span class="n">By</span> <span class="n">removing</span> <span class="n">these</span> <span class="n">vertices</span> <span class="n">prior</span> <span class="n">to</span> <span class="n">ordering</span><span class="p">,</span> <span class="n">the</span> <span class="n">quality</span> <span class="n">and</span> <span class="n">the</span>
<a id="ln-231" name="ln-231"></a>  <span class="err">!!</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">time</span> <span class="n">required</span> <span class="n">to</span> <span class="n">do</span> <span class="n">the</span> <span class="n">ordering</span> <span class="n">improves</span>
<a id="ln-232" name="ln-232"></a>
<a id="ln-233" name="ln-233"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-234" name="ln-234"></a><span class="err">!</span>
<a id="ln-235" name="ln-235"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-236" name="ln-236"></a>
<a id="ln-237" name="ln-237"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_NSEPS</span>  <span class="o">=</span> <span class="mi">15</span>
<a id="ln-238" name="ln-238"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">different</span> <span class="n">separators</span> <span class="n">that</span> <span class="n">it</span> <span class="n">will</span> <span class="n">compute</span> <span class="n">at</span> <span class="n">each</span> <span class="n">level</span> <span class="n">of</span> <span class="n">nested</span> <span class="n">dissection</span><span class="err">.</span> <span class="n">The</span> <span class="n">final</span> <span class="n">separator</span> <span class="n">that</span> <span class="n">is</span> <span class="n">used</span> <span class="n">is</span> <span class="n">the</span> <span class="n">smallest</span> <span class="n">one</span><span class="err">.</span> <span class="n">Default</span> <span class="n">is</span> <span class="mi">1</span>
<a id="ln-239" name="ln-239"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_NSEPS_DEFAULT</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-240" name="ln-240"></a>
<a id="ln-241" name="ln-241"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-242" name="ln-242"></a><span class="err">!</span>
<a id="ln-243" name="ln-243"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-244" name="ln-244"></a>
<a id="ln-245" name="ln-245"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_UFACTOR</span> <span class="o">=</span> <span class="mi">16</span>
<a id="ln-246" name="ln-246"></a>  <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">allowed</span> <span class="n">load</span> <span class="n">imbalance</span> <span class="n">among</span> <span class="n">the</span> <span class="n">partitions</span><span class="err">.</span> <span class="n">A</span>
<a id="ln-247" name="ln-247"></a>  <span class="err">!!</span> <span class="n">value</span> <span class="n">of</span> <span class="bp">x</span> <span class="n">indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">allowed</span> <span class="n">load</span> <span class="n">imbalance</span> <span class="n">is</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">x</span><span class="p">)</span><span class="o">=</span><span class="mf">1000.</span>
<a id="ln-248" name="ln-248"></a>  <span class="err">!!</span> <span class="n">The</span> <span class="n">load</span> <span class="n">imbalance</span> <span class="n">for</span> <span class="n">the</span> <span class="n">jth</span> <span class="n">constraint</span> <span class="n">is</span> <span class="n">defined</span> <span class="n">to</span> <span class="n">be</span> <span class="n">maxi</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="p">])</span>
<a id="ln-249" name="ln-249"></a>  <span class="err">!!</span> <span class="o">=</span><span class="k">t</span><span class="p">[</span><span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="p">]),</span> <span class="n">where</span> <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="p">]</span> <span class="n">is</span> <span class="n">the</span> <span class="n">fraction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">overall</span> <span class="n">weight</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-250" name="ln-250"></a>  <span class="err">!!</span> <span class="n">jth</span> <span class="n">constraint</span> <span class="n">that</span> <span class="n">is</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">ith</span> <span class="n">partition</span> <span class="n">and</span> <span class="k">t</span><span class="p">[</span><span class="n">j</span><span class="p">;</span> <span class="n">i</span><span class="p">]</span> <span class="n">is</span> <span class="n">the</span>
<a id="ln-251" name="ln-251"></a>  <span class="err">!!</span> <span class="n">desired</span> <span class="n">target</span> <span class="n">weight</span> <span class="n">of</span> <span class="n">the</span> <span class="n">jth</span> <span class="n">constraint</span> <span class="n">for</span> <span class="n">the</span> <span class="n">ith</span> <span class="n">partition</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span>
<a id="ln-252" name="ln-252"></a>  <span class="err">!!</span> <span class="n">that</span> <span class="n">specified</span> <span class="n">via</span> <span class="o">-</span><span class="n">tpwgts</span><span class="p">)</span><span class="err">.</span> <span class="n">For</span> <span class="o">-</span><span class="n">ptype</span><span class="o">=</span><span class="n">rb</span><span class="p">,</span> <span class="n">the</span> <span class="k">default</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">1</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span>
<a id="ln-253" name="ln-253"></a>  <span class="err">!!</span> <span class="p">,</span> <span class="n">load</span> <span class="n">imbalance</span> <span class="n">of</span> <span class="mf">1.001</span><span class="p">)</span> <span class="n">and</span> <span class="n">for</span> <span class="o">-</span><span class="n">ptype</span><span class="o">=</span><span class="n">kway</span><span class="p">,</span> <span class="n">the</span> <span class="k">default</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">30</span>
<a id="ln-254" name="ln-254"></a>  <span class="err">!!</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span> <span class="n">load</span> <span class="n">imbalance</span> <span class="n">of</span> <span class="mf">1.03</span><span class="p">)</span><span class="err">.</span>
<a id="ln-255" name="ln-255"></a>
<a id="ln-256" name="ln-256"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-257" name="ln-257"></a><span class="err">!</span>
<a id="ln-258" name="ln-258"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-259" name="ln-259"></a>
<a id="ln-260" name="ln-260"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_OPTION_NUMBERING</span> <span class="o">=</span> <span class="mi">17</span>
<a id="ln-261" name="ln-261"></a>  <span class="err">!!</span> <span class="n">Used</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">which</span> <span class="n">numbering</span> <span class="n">scheme</span> <span class="n">is</span> <span class="n">used</span> <span class="n">for</span> <span class="n">the</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">or</span> <span class="n">the</span> <span class="n">element</span><span class="o">-</span><span class="n">node</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-262" name="ln-262"></a>  <span class="err">!!</span> <span class="n">The</span> <span class="n">possible</span> <span class="n">values</span> <span class="n">are</span> <span class="mi">0</span> <span class="n">for</span> <span class="n">C</span><span class="o">-</span><span class="n">style</span><span class="p">,</span> <span class="n">and</span> <span class="mi">1</span> <span class="n">for</span> <span class="n">Fortran</span> <span class="n">style</span>
<a id="ln-263" name="ln-263"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_NUMBERING_DEFAULT</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-264" name="ln-264"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_NUMBERING_FORTRAN</span> <span class="o">=</span> <span class="mi">1</span>
<a id="ln-265" name="ln-265"></a><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">PARAMETER</span><span class="p">,</span> <span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_NUMBERING_C</span> <span class="o">=</span> <span class="mi">0</span>
<a id="ln-266" name="ln-266"></a>
<a id="ln-267" name="ln-267"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-268" name="ln-268"></a><span class="err">!</span>                                                  <span class="n">METIS_SetDefaultOptions</span>
<a id="ln-269" name="ln-269"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-270" name="ln-270"></a>
<a id="ln-271" name="ln-271"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-272" name="ln-272"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">27</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-273" name="ln-273"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> <span class="n">Initializes</span> <span class="n">the</span> <span class="n">options</span> <span class="n">array</span> <span class="n">into</span> <span class="n">its</span> <span class="k">default</span> <span class="n">values</span><span class="err">.</span>
<a id="ln-274" name="ln-274"></a><span class="err">!</span>
<a id="ln-275" name="ln-275"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-276" name="ln-276"></a><span class="err">!</span> <span class="n">Initializes</span> <span class="n">the</span> <span class="n">options</span> <span class="n">array</span> <span class="n">into</span> <span class="n">its</span> <span class="k">default</span> <span class="n">values</span><span class="err">.</span>
<a id="ln-277" name="ln-277"></a><span class="err">!</span>
<a id="ln-278" name="ln-278"></a><span class="err">!@</span><span class="n">note</span>
<a id="ln-279" name="ln-279"></a><span class="err">!</span> <span class="n">The</span> <span class="n">passed</span> <span class="n">array</span> <span class="err">`</span><span class="n">options</span><span class="err">`</span> <span class="n">must</span> <span class="n">have</span> <span class="n">the</span> <span class="n">size</span> <span class="err">`</span><span class="n">MAX_METIS_OPTIONS</span><span class="err">`</span> <span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="err">.</span>
<a id="ln-280" name="ln-280"></a><span class="err">!</span> <span class="n">To</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">use</span> <span class="n">the</span> <span class="n">option</span> <span class="n">parameters</span> <span class="n">specified</span> <span class="n">in</span> <span class="n">the</span> <span class="p">[[</span><span class="n">metis_interface</span><span class="p">]]</span> <span class="n">module</span>
<a id="ln-281" name="ln-281"></a><span class="err">!</span> <span class="n">it</span> <span class="n">is</span> <span class="n">recommended</span> <span class="n">to</span> <span class="n">use</span> <span class="n">zero</span><span class="o">-</span><span class="n">based</span> <span class="n">indexing</span> <span class="n">for</span> <span class="n">the</span> <span class="n">options</span> <span class="n">array</span><span class="err">:</span>
<a id="ln-282" name="ln-282"></a><span class="err">!```</span><span class="n">Fortran</span>
<a id="ln-283" name="ln-283"></a><span class="err">!</span><span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">opts</span><span class="p">(</span><span class="mi">0</span><span class="err">:</span><span class="mi">39</span><span class="p">)</span>
<a id="ln-284" name="ln-284"></a><span class="err">!```</span>
<a id="ln-285" name="ln-285"></a><span class="err">!@</span><span class="n">endnote</span>
<a id="ln-286" name="ln-286"></a><span class="err">!</span>
<a id="ln-287" name="ln-287"></a><span class="err">!</span> <span class="n">Other</span> <span class="n">options</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">changed</span> <span class="n">using</span> <span class="n">parameters</span> <span class="n">specified</span> <span class="n">in</span> <span class="n">the</span> <span class="p">[[</span><span class="n">metis_interface</span><span class="p">]]</span> <span class="n">module</span><span class="err">.</span>
<a id="ln-288" name="ln-288"></a>
<a id="ln-289" name="ln-289"></a><span class="n">INTERFACE</span>
<a id="ln-290" name="ln-290"></a><span class="n">FUNCTION</span> <span class="n">METIS_SetDefaultOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="n">RESULT</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span> <span class="n">BIND</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;METIS_SetDefaultOptions&quot;</span><span class="p">)</span>
<a id="ln-291" name="ln-291"></a>  <span class="n">IMPORT</span>
<a id="ln-292" name="ln-292"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">options</span><span class="p">(</span><span class="n">MAX_METIS_OPTIONS</span><span class="p">)</span>
<a id="ln-293" name="ln-293"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">array</span> <span class="n">of</span> <span class="n">options</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">initialized</span><span class="err">.</span>
<a id="ln-294" name="ln-294"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-295" name="ln-295"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span>
<a id="ln-296" name="ln-296"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_SetDefaultOptions</span>
<a id="ln-297" name="ln-297"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-298" name="ln-298"></a>
<a id="ln-299" name="ln-299"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_SetDefaultOptions</span>
<a id="ln-300" name="ln-300"></a>
<a id="ln-301" name="ln-301"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-302" name="ln-302"></a><span class="err">!</span>                                                              <span class="n">METIS_NodeND</span>
<a id="ln-303" name="ln-303"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-304" name="ln-304"></a>
<a id="ln-305" name="ln-305"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-306" name="ln-306"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">27</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-307" name="ln-307"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> <span class="n">This</span> <span class="n">function</span> <span class="n">computes</span> <span class="n">fill</span> <span class="n">reducing</span> <span class="n">orderings</span> <span class="n">of</span> <span class="n">sparse</span> <span class="n">matrices</span> <span class="n">using</span> <span class="n">the</span> <span class="n">multilevel</span> <span class="n">nested</span> <span class="n">dissection</span> <span class="n">algorithm</span><span class="err">.</span>
<a id="ln-308" name="ln-308"></a><span class="err">!</span>
<a id="ln-309" name="ln-309"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-310" name="ln-310"></a><span class="err">!</span> <span class="n">This</span> <span class="n">function</span> <span class="n">computes</span> <span class="n">fill</span> <span class="n">reducing</span> <span class="n">orderings</span> <span class="n">of</span> <span class="n">sparse</span> <span class="n">matrices</span> <span class="n">using</span> <span class="n">the</span>
<a id="ln-311" name="ln-311"></a><span class="err">!</span> <span class="n">multilevel</span> <span class="n">nested</span> <span class="n">dissection</span> <span class="n">algorithm</span><span class="err">.</span>
<a id="ln-312" name="ln-312"></a><span class="err">!</span>
<a id="ln-313" name="ln-313"></a><span class="err">!</span> <span class="n">Let</span> <span class="err">$</span><span class="n">A</span><span class="err">$</span> <span class="n">be</span> <span class="n">the</span> <span class="n">original</span> <span class="k">matrix</span> <span class="n">and</span> <span class="err">$</span><span class="n">A</span><span class="o">*</span><span class="err">$</span> <span class="n">be</span> <span class="n">the</span> <span class="n">permuted</span> <span class="k">matrix</span><span class="err">.</span>
<a id="ln-314" name="ln-314"></a><span class="err">!</span> <span class="n">The</span> <span class="n">arrays</span> <span class="err">`</span><span class="n">perm</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">iperm</span><span class="err">`</span> <span class="n">are</span> <span class="n">defined</span> <span class="n">as</span> <span class="n">follows</span><span class="err">.</span> <span class="n">Row</span> <span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="err">`</span><span class="n">i</span><span class="err">`</span> <span class="n">of</span> <span class="err">$</span><span class="n">A</span><span class="o">*</span><span class="err">$</span> <span class="n">is</span> <span class="n">the</span> <span class="err">`</span><span class="n">perm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">`</span> <span class="n">row</span> <span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="n">of</span> <span class="err">$</span><span class="n">A</span><span class="err">$</span><span class="p">,</span> <span class="n">and</span> <span class="n">row</span> <span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="err">`</span><span class="n">i</span><span class="err">`</span> <span class="n">of</span> <span class="err">$</span><span class="n">A</span><span class="err">$</span> <span class="n">is</span> <span class="n">the</span> <span class="err">`</span><span class="n">iperm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">`</span> <span class="n">row</span> <span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="n">of</span> <span class="err">$</span><span class="n">A</span><span class="o">*</span><span class="err">$.</span>
<a id="ln-315" name="ln-315"></a><span class="err">!</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="err">`</span><span class="n">options</span><span class="p">(</span><span class="n">METIS_OPTION_NUMBERING</span><span class="p">)</span><span class="err">`.</span>
<a id="ln-316" name="ln-316"></a><span class="err">!</span>
<a id="ln-317" name="ln-317"></a><span class="err">!</span> <span class="n">If</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">is</span> <span class="n">weighted</span><span class="p">,</span> <span class="n">meaning</span> <span class="err">`</span><span class="n">vgwt</span><span class="err">`</span> <span class="n">was</span> <span class="n">provided</span><span class="p">,</span> <span class="n">the</span> <span class="n">nested</span> <span class="n">dissection</span> <span class="n">ordering</span> <span class="n">computes</span> <span class="n">vertex</span> <span class="n">separators</span> <span class="n">that</span> <span class="n">minimize</span> <span class="n">the</span> <span class="n">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span> <span class="k">on</span> <span class="n">the</span> <span class="n">separators</span><span class="err">.</span>
<a id="ln-318" name="ln-318"></a><span class="err">!</span>
<a id="ln-319" name="ln-319"></a><span class="err">!</span> <span class="n">THE</span> <span class="n">FOLLOWING</span> <span class="n">OPTIONS</span> <span class="n">ARE</span> <span class="n">VALID</span><span class="err">:</span>
<a id="ln-320" name="ln-320"></a><span class="err">!</span>
<a id="ln-321" name="ln-321"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_CTYPE</span><span class="err">`</span>
<a id="ln-322" name="ln-322"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_RTYPE</span><span class="err">`</span>
<a id="ln-323" name="ln-323"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NO2HOP</span><span class="err">`</span>
<a id="ln-324" name="ln-324"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NSEPS</span><span class="err">`</span>
<a id="ln-325" name="ln-325"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NITER</span><span class="err">`</span>
<a id="ln-326" name="ln-326"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_UFACTOR</span><span class="err">`</span>
<a id="ln-327" name="ln-327"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_COMPRESS</span><span class="err">`</span>
<a id="ln-328" name="ln-328"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_CCORDER</span><span class="err">`</span>
<a id="ln-329" name="ln-329"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_SEED</span><span class="err">`</span>
<a id="ln-330" name="ln-330"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_PFACTOR</span><span class="err">`</span>
<a id="ln-331" name="ln-331"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NUMBERING</span><span class="err">`</span>
<a id="ln-332" name="ln-332"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_DBGLVL</span><span class="err">`</span>
<a id="ln-333" name="ln-333"></a><span class="err">!</span>
<a id="ln-334" name="ln-334"></a><span class="err">!</span> <span class="n">CInterface</span>
<a id="ln-335" name="ln-335"></a><span class="err">!</span> <span class="k">int</span> <span class="n">METIS_NodeND</span><span class="p">(</span><span class="n">idx_t</span> <span class="o">*</span><span class="n">nvtxs</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">xadj</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">adjncy</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">vwgt</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">options</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">perm</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">iperm</span><span class="p">)</span>
<a id="ln-336" name="ln-336"></a><span class="err">!</span>
<a id="ln-337" name="ln-337"></a><span class="err">!</span> <span class="n">Optional</span> <span class="n">argument</span> <span class="err">:</span> <span class="n">vwgt</span><span class="p">,</span> <span class="n">options</span>
<a id="ln-338" name="ln-338"></a>
<a id="ln-339" name="ln-339"></a><span class="n">INTERFACE</span>
<a id="ln-340" name="ln-340"></a><span class="n">FUNCTION</span> <span class="n">METIS_NodeND</span><span class="p">(</span> <span class="n">nvtxs</span><span class="p">,</span> <span class="n">xadj</span><span class="p">,</span> <span class="n">adjncy</span><span class="p">,</span> <span class="n">vwgt</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">perm</span><span class="p">,</span> <span class="n">iperm</span> <span class="p">)</span> <span class="err">&amp;</span>
<a id="ln-341" name="ln-341"></a>  <span class="err">&amp;</span> <span class="n">RESULT</span><span class="p">(</span> <span class="n">Ans</span> <span class="p">)</span> <span class="n">BIND</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;METIS_NodeND&quot;</span> <span class="p">)</span>
<a id="ln-342" name="ln-342"></a>  <span class="n">IMPORT</span>
<a id="ln-343" name="ln-343"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">nvtxs</span>
<a id="ln-344" name="ln-344"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">vertices</span> <span class="n">in</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-345" name="ln-345"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">xadj</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">adjncy</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="ln-346" name="ln-346"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.5</span> <span class="n">of</span>
<a id="ln-347" name="ln-347"></a>    <span class="err">!!</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-348" name="ln-348"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">vwgt</span>
<a id="ln-349" name="ln-349"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nvtxs</span><span class="err">`</span> <span class="n">specifying</span> <span class="n">the</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span><span class="err">.</span>
<a id="ln-350" name="ln-350"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span>  <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">options</span> <span class="err">!</span><span class="p">(</span> <span class="n">MAX_METIS_OPTIONS</span> <span class="p">)</span>
<a id="ln-351" name="ln-351"></a>    <span class="err">!!</span> <span class="n">This</span> <span class="n">is</span> <span class="n">the</span> <span class="n">array</span> <span class="n">of</span> <span class="n">options</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.4</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf). See description for valid options.</span>
<a id="ln-352" name="ln-352"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">OUT</span> <span class="p">)</span> <span class="err">::</span> <span class="n">perm</span><span class="p">(</span><span class="n">nvtxs</span><span class="p">),</span> <span class="n">iperm</span><span class="p">(</span><span class="n">nvtxs</span><span class="p">)</span>
<a id="ln-353" name="ln-353"></a>    <span class="err">!!</span> <span class="n">These</span> <span class="n">are</span> <span class="n">vectors</span><span class="p">,</span> <span class="n">each</span> <span class="n">of</span> <span class="n">size</span> <span class="n">nvtxs</span><span class="err">.</span> <span class="n">Upon</span> <span class="n">successful</span> <span class="n">completion</span><span class="p">,</span>
<a id="ln-354" name="ln-354"></a>    <span class="err">!!</span> <span class="n">they</span> <span class="n">store</span> <span class="n">the</span> <span class="n">fill</span><span class="o">-</span><span class="n">reducing</span> <span class="n">permutation</span> <span class="n">and</span> <span class="k">inverse</span><span class="o">-</span><span class="n">permutation</span><span class="err">.</span> <span class="n">Let</span>
<a id="ln-355" name="ln-355"></a>    <span class="err">!!</span> <span class="n">A</span> <span class="n">be</span> <span class="n">the</span> <span class="n">original</span> <span class="k">matrix</span> <span class="n">and</span> <span class="err">$</span><span class="n">A</span><span class="o">*</span><span class="err">$</span> <span class="n">be</span> <span class="n">the</span> <span class="n">permuted</span> <span class="k">matrix</span><span class="err">.</span>
<a id="ln-356" name="ln-356"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">arrays</span> <span class="err">`</span><span class="n">perm</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">iperm</span><span class="err">`</span> <span class="n">are</span> <span class="n">defined</span> <span class="n">as</span> <span class="n">follows</span><span class="err">.</span>
<a id="ln-357" name="ln-357"></a>    <span class="err">!!</span> <span class="n">Row</span> <span class="p">(</span><span class="n">or</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span> <span class="err">$</span><span class="n">i</span><span class="err">$</span> <span class="n">of</span> <span class="err">$</span><span class="n">A</span><span class="o">*</span><span class="err">$</span> <span class="n">is</span> <span class="n">the</span> <span class="err">`</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="err">`</span> <span class="n">row</span> <span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="n">of</span> <span class="n">A</span><span class="p">,</span>
<a id="ln-358" name="ln-358"></a>    <span class="err">!!</span> <span class="n">and</span> <span class="n">row</span> <span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="err">$</span><span class="n">i</span><span class="err">$</span> <span class="n">of</span> <span class="err">$</span><span class="n">A</span><span class="err">$</span> <span class="n">is</span> <span class="n">the</span> <span class="err">`</span><span class="n">iperm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="err">`</span> <span class="n">row</span> <span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="n">of</span> <span class="n">A0</span><span class="err">.</span>
<a id="ln-359" name="ln-359"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span>
<a id="ln-360" name="ln-360"></a>    <span class="err">!!</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">options</span><span class="p">[</span><span class="n">METIS</span> <span class="n">OPTION</span> <span class="n">NUMBERING</span><span class="p">]</span>
<a id="ln-361" name="ln-361"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-362" name="ln-362"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-363" name="ln-363"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_INPUT</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">an</span> <span class="n">input</span> <span class="k">error</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-364" name="ln-364"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_MEMORY</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">it</span> <span class="n">could</span> <span class="n">not</span> <span class="n">allocate</span> <span class="n">the</span> <span class="n">required</span> <span class="n">memory</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-365" name="ln-365"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">some</span> <span class="n">other</span> <span class="k">type</span> <span class="n">of</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-366" name="ln-366"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_NodeND</span>
<a id="ln-367" name="ln-367"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-368" name="ln-368"></a>
<a id="ln-369" name="ln-369"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_NodeND</span>
<a id="ln-370" name="ln-370"></a>
<a id="ln-371" name="ln-371"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-372" name="ln-372"></a><span class="err">!</span>                                                   <span class="n">METIS_PartGraphRecursive</span>
<a id="ln-373" name="ln-373"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-374" name="ln-374"></a>
<a id="ln-375" name="ln-375"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-376" name="ln-376"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">27</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-377" name="ln-377"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> <span class="n">this</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span>
<a id="ln-378" name="ln-378"></a><span class="err">!</span> <span class="n">parts</span> <span class="n">using</span> <span class="n">recursive</span> <span class="n">bisection</span><span class="err">.</span>
<a id="ln-379" name="ln-379"></a><span class="err">!</span>
<a id="ln-380" name="ln-380"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-381" name="ln-381"></a><span class="err">!</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">parts</span> <span class="n">using</span>
<a id="ln-382" name="ln-382"></a><span class="err">!</span> <span class="n">recursive</span> <span class="n">bisection</span><span class="err">.</span>
<a id="ln-383" name="ln-383"></a><span class="err">!</span>
<a id="ln-384" name="ln-384"></a><span class="err">!</span> <span class="n">THE</span> <span class="n">FOLLOWING</span> <span class="n">OPTIONS</span> <span class="n">ARE</span> <span class="n">VALID</span><span class="err">:</span>
<a id="ln-385" name="ln-385"></a><span class="err">!</span>
<a id="ln-386" name="ln-386"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_CTYPE</span><span class="err">`</span>
<a id="ln-387" name="ln-387"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_IPTYPE</span><span class="err">`</span>
<a id="ln-388" name="ln-388"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_RTYPE</span><span class="err">`</span>
<a id="ln-389" name="ln-389"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NO2HOP</span><span class="err">`</span>
<a id="ln-390" name="ln-390"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NCUTS</span><span class="err">`</span>
<a id="ln-391" name="ln-391"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NITER</span><span class="err">`</span>
<a id="ln-392" name="ln-392"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_SEED</span><span class="err">`</span>
<a id="ln-393" name="ln-393"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_UFACTOR</span><span class="err">`</span>
<a id="ln-394" name="ln-394"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NUMBERING</span><span class="err">`</span>
<a id="ln-395" name="ln-395"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_DBGLVL</span><span class="err">`</span>
<a id="ln-396" name="ln-396"></a><span class="err">!</span>
<a id="ln-397" name="ln-397"></a><span class="err">!</span> <span class="n">OPTIONAL</span> <span class="err">::</span> <span class="n">VWGT</span><span class="p">,</span> <span class="n">VSIZE</span><span class="p">,</span> <span class="n">ADJWGT</span><span class="p">,</span> <span class="n">TPWGTS</span><span class="p">,</span> <span class="n">UBVEC</span><span class="p">,</span> <span class="n">OPTIONS</span>
<a id="ln-398" name="ln-398"></a><span class="err">!</span>
<a id="ln-399" name="ln-399"></a><span class="err">!</span> <span class="n">int_METIS_PartGraphRecursive</span><span class="p">(</span><span class="n">idx_t</span> <span class="o">*</span><span class="n">nvtxs</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">ncon</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">xadj</span><span class="p">,</span> <span class="n">idx_t</span> <span class="err">!</span> <span class="o">*</span><span class="n">adjncy</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">vwgt</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">vsize</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">adjwgt</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">nparts</span><span class="p">,</span> <span class="n">real_t</span> <span class="o">*</span><span class="n">tpwgts</span><span class="p">,</span> <span class="n">real_t</span> <span class="o">*</span><span class="n">ubvec</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">options</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">objval</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">part</span><span class="p">)</span>
<a id="ln-400" name="ln-400"></a>
<a id="ln-401" name="ln-401"></a><span class="n">INTERFACE</span>
<a id="ln-402" name="ln-402"></a><span class="n">FUNCTION</span> <span class="n">METIS_PartGraphRecursive</span><span class="p">(</span> <span class="n">nvtxs</span><span class="p">,</span> <span class="n">ncon</span><span class="p">,</span> <span class="n">xadj</span><span class="p">,</span> <span class="n">adjncy</span><span class="p">,</span> <span class="err">&amp;</span>
<a id="ln-403" name="ln-403"></a>  <span class="err">&amp;</span> <span class="n">vwgt</span><span class="p">,</span> <span class="n">vsize</span><span class="p">,</span> <span class="n">adjwgt</span><span class="p">,</span> <span class="n">nparts</span><span class="p">,</span> <span class="n">tpwgts</span><span class="p">,</span> <span class="n">ubvec</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">objval</span><span class="p">,</span> <span class="n">part</span> <span class="p">)</span> <span class="err">&amp;</span>
<a id="ln-404" name="ln-404"></a>  <span class="err">&amp;</span> <span class="n">RESULT</span><span class="p">(</span> <span class="n">ans</span> <span class="p">)</span> <span class="n">BIND</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;METIS_PartGraphRecursive&quot;</span><span class="p">)</span>
<a id="ln-405" name="ln-405"></a>  <span class="n">IMPORT</span>
<a id="ln-406" name="ln-406"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">nvtxs</span>
<a id="ln-407" name="ln-407"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">vertices</span> <span class="n">in</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-408" name="ln-408"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ncon</span>
<a id="ln-409" name="ln-409"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">balancing</span> <span class="n">constraints</span> <span class="k">on</span> <span class="n">each</span> <span class="n">node</span><span class="err">.</span>
<a id="ln-410" name="ln-410"></a>    <span class="err">!!</span> <span class="n">It</span> <span class="n">should</span> <span class="n">be</span> <span class="n">atleast</span> <span class="mf">1.</span>
<a id="ln-411" name="ln-411"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">xadj</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">adjncy</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="ln-412" name="ln-412"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span>
<a id="ln-413" name="ln-413"></a>    <span class="err">!!</span> <span class="n">section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-414" name="ln-414"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-415" name="ln-415"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">vwgt</span>
<a id="ln-416" name="ln-416"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-417" name="ln-417"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-418" name="ln-418"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">vsize</span>
<a id="ln-419" name="ln-419"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">for</span> <span class="n">computing</span> <span class="n">the</span> <span class="n">total</span> <span class="n">communication</span> <span class="n">volume</span>
<a id="ln-420" name="ln-420"></a>    <span class="err">!!</span>  <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">section</span> <span class="mf">5.7</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-421" name="ln-421"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-422" name="ln-422"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">adjwgt</span>
<a id="ln-423" name="ln-423"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">edges</span> <span class="n">as</span> <span class="n">describe</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-424" name="ln-424"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-425" name="ln-425"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nparts</span>
<a id="ln-426" name="ln-426"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">parts</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-427" name="ln-427"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">tpwgts</span>
<a id="ln-428" name="ln-428"></a>    <span class="err">!!</span> <span class="n">This</span> <span class="n">is</span> <span class="n">an</span> <span class="n">array</span> <span class="n">pf</span> <span class="n">size</span><span class="err">`</span><span class="n">nparts</span><span class="o">*</span><span class="n">ncon</span><span class="err">`</span> <span class="n">that</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">desired</span>
<a id="ln-429" name="ln-429"></a>    <span class="err">!!</span> <span class="n">weight</span> <span class="n">for</span> <span class="n">each</span> <span class="n">partition</span> <span class="n">and</span> <span class="n">constraint</span><span class="err">.</span>
<a id="ln-430" name="ln-430"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">target</span> <span class="n">partition</span> <span class="n">weight</span> <span class="n">for</span> <span class="n">the</span> <span class="n">ith</span> <span class="n">partition</span> <span class="n">and</span>
<a id="ln-431" name="ln-431"></a>    <span class="err">!!</span> <span class="n">jth</span> <span class="n">constraint</span> <span class="n">is</span> <span class="n">specified</span> <span class="n">at</span> <span class="err">`</span><span class="n">tpwgts</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">ncon</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="err">`.</span>
<a id="ln-432" name="ln-432"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">for</span> <span class="n">both</span> <span class="n">partition</span> <span class="n">and</span> <span class="n">constraints</span> <span class="n">starts</span> <span class="n">from</span> <span class="mf">0.</span>
<a id="ln-433" name="ln-433"></a>    <span class="err">!!</span> <span class="n">For</span> <span class="n">each</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">the</span> <span class="n">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="err">`</span><span class="n">tpwgts</span><span class="p">[]</span><span class="err">`</span> <span class="n">entries</span> <span class="n">must</span> <span class="n">be</span> <span class="mf">1.0</span><span class="err">.</span>
<a id="ln-434" name="ln-434"></a>    <span class="err">!!</span> <span class="n">If</span> <span class="n">not</span> <span class="n">present</span><span class="p">,</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">is</span> <span class="n">divided</span> <span class="n">equally</span> <span class="n">among</span> <span class="n">the</span> <span class="n">partitions</span><span class="err">.</span>
<a id="ln-435" name="ln-435"></a>    <span class="err">!!</span> <span class="n">More</span> <span class="n">in</span> <span class="n">the</span> <span class="n">description</span><span class="err">.</span>
<a id="ln-436" name="ln-436"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ubvec</span>
<a id="ln-437" name="ln-437"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">ncon</span><span class="err">`</span> <span class="n">that</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">allowed</span> <span class="n">load</span> <span class="n">imbalance</span>
<a id="ln-438" name="ln-438"></a>    <span class="err">!!</span> <span class="n">for</span> <span class="n">each</span> <span class="n">constraint</span><span class="err">.</span>
<a id="ln-439" name="ln-439"></a>    <span class="err">!!</span> <span class="n">For</span> <span class="n">the</span> <span class="err">`</span><span class="n">i</span><span class="err">`</span><span class="o">-</span><span class="n">th</span> <span class="n">partition</span> <span class="n">and</span> <span class="err">`</span><span class="n">j</span><span class="err">`</span><span class="o">-</span><span class="n">th</span> <span class="n">constraint</span> <span class="n">the</span> <span class="n">allowed</span>
<a id="ln-440" name="ln-440"></a>    <span class="err">!!</span> <span class="n">weight</span> <span class="n">is</span> <span class="n">the</span> <span class="err">`</span><span class="n">ubvec</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">tpwgts</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">ncon</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="err">`</span>
<a id="ln-441" name="ln-441"></a>    <span class="err">!!</span> <span class="n">fraction</span> <span class="n">of</span> <span class="n">the</span> <span class="err">`</span><span class="n">j</span><span class="err">`</span><span class="o">-</span><span class="n">th</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">constraint</span> <span class="n">total</span> <span class="n">weight</span><span class="err">.</span>
<a id="ln-442" name="ln-442"></a>    <span class="err">!!</span> <span class="n">If</span> <span class="n">not</span> <span class="n">present</span><span class="p">,</span> <span class="n">the</span> <span class="n">load</span> <span class="n">imbalance</span>
<a id="ln-443" name="ln-443"></a>    <span class="err">!!</span> <span class="n">tolerance</span> <span class="n">is</span> <span class="mf">1.001</span> <span class="p">(</span><span class="n">for</span> <span class="err">`</span><span class="n">ncon</span> <span class="o">=</span> <span class="mi">1</span><span class="err">`</span><span class="p">)</span> <span class="n">or</span> <span class="mf">1.01</span> <span class="p">(</span><span class="n">for</span> <span class="err">`</span><span class="n">ncon</span> <span class="p">&gt;</span> <span class="mi">1</span><span class="err">`</span><span class="p">)</span><span class="err">.</span>
<a id="ln-444" name="ln-444"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">options</span>
<a id="ln-445" name="ln-445"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">options</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.4</span> <span class="n">of</span> <span class="n">the</span> <span class="n">METIS</span> <span class="n">manual</span><span class="err">.</span>
<a id="ln-446" name="ln-446"></a>    <span class="err">!!</span> <span class="n">See</span> <span class="n">description</span> <span class="n">for</span> <span class="n">valid</span> <span class="n">options</span><span class="err">.</span>
<a id="ln-447" name="ln-447"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">objval</span>
<a id="ln-448" name="ln-448"></a>    <span class="err">!!</span> <span class="n">Upon</span> <span class="n">successful</span> <span class="n">completion</span><span class="p">,</span> <span class="n">this</span> <span class="n">variable</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">edge</span><span class="o">-</span><span class="n">cut</span> <span class="n">or</span> <span class="n">the</span>
<a id="ln-449" name="ln-449"></a>    <span class="err">!!</span> <span class="n">total</span> <span class="n">communication</span> <span class="n">volume</span> <span class="n">of</span> <span class="n">the</span> <span class="n">partitioning</span>
<a id="ln-450" name="ln-450"></a>    <span class="err">!!</span> <span class="n">solution</span><span class="err">.</span> <span class="n">The</span> <span class="n">value</span> <span class="n">returned</span> <span class="n">depends</span> <span class="k">on</span> <span class="n">the</span> <span class="n">partitioning</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">objective</span>
<a id="ln-451" name="ln-451"></a>    <span class="err">!!</span> <span class="n">function</span><span class="err">.</span>
<a id="ln-452" name="ln-452"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">part</span><span class="p">(</span><span class="n">nvtxs</span><span class="p">)</span>
<a id="ln-453" name="ln-453"></a>    <span class="err">!!</span> <span class="n">This</span> <span class="n">is</span> <span class="n">a</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nvtxs</span><span class="err">`</span> <span class="n">that</span> <span class="n">upon</span> <span class="n">successful</span> <span class="n">completion</span>
<a id="ln-454" name="ln-454"></a>    <span class="err">!!</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">partition</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-455" name="ln-455"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span>
<a id="ln-456" name="ln-456"></a>    <span class="err">!!</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="err">`</span><span class="n">options</span><span class="p">(</span><span class="n">METIS_OPTION_NUMBERING</span><span class="p">)</span><span class="err">`.</span>
<a id="ln-457" name="ln-457"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-458" name="ln-458"></a>    <span class="err">!!</span> <span class="n">Error</span> <span class="n">code</span>
<a id="ln-459" name="ln-459"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span>
<a id="ln-460" name="ln-460"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_INPUT</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">an</span> <span class="n">input</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-461" name="ln-461"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_MEMORY</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">it</span> <span class="n">could</span> <span class="n">not</span> <span class="n">allocate</span> <span class="n">the</span> <span class="n">required</span> <span class="n">memory</span><span class="err">.</span>
<a id="ln-462" name="ln-462"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">some</span> <span class="n">other</span> <span class="k">type</span> <span class="n">of</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-463" name="ln-463"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_PartGraphRecursive</span>
<a id="ln-464" name="ln-464"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-465" name="ln-465"></a>
<a id="ln-466" name="ln-466"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PartGraphRecursive</span>
<a id="ln-467" name="ln-467"></a>
<a id="ln-468" name="ln-468"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-469" name="ln-469"></a><span class="err">!</span>                                                       <span class="n">METIS_PartGraphKway</span>
<a id="ln-470" name="ln-470"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-471" name="ln-471"></a>
<a id="ln-472" name="ln-472"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-473" name="ln-473"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">27</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-474" name="ln-474"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">parts</span> <span class="n">using</span> <span class="n">multilevel</span> <span class="n">k</span><span class="o">-</span><span class="n">way</span> <span class="n">partitioning</span><span class="err">.</span>
<a id="ln-475" name="ln-475"></a><span class="err">!</span>
<a id="ln-476" name="ln-476"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-477" name="ln-477"></a><span class="err">!</span>
<a id="ln-478" name="ln-478"></a><span class="err">!</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">parts</span> <span class="n">using</span> <span class="n">multilevel</span> <span class="n">k</span><span class="o">-</span><span class="n">way</span> <span class="n">partitioning</span><span class="err">.</span>
<a id="ln-479" name="ln-479"></a><span class="err">!</span>
<a id="ln-480" name="ln-480"></a><span class="err">!</span> <span class="n">THE</span> <span class="n">FOLLOWING</span> <span class="n">OPTIONS</span> <span class="n">ARE</span> <span class="n">VALID</span><span class="err">:</span>
<a id="ln-481" name="ln-481"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_OBJTYPE</span><span class="err">`</span>
<a id="ln-482" name="ln-482"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_CTYPE</span><span class="err">`</span>
<a id="ln-483" name="ln-483"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_IPTYPE</span><span class="err">`</span>
<a id="ln-484" name="ln-484"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_RTYPE</span><span class="err">`</span>
<a id="ln-485" name="ln-485"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NO2HOP</span><span class="err">`</span>
<a id="ln-486" name="ln-486"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NCUTS</span><span class="err">`</span>
<a id="ln-487" name="ln-487"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NITER</span><span class="err">`</span>
<a id="ln-488" name="ln-488"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_UFACTOR</span><span class="err">`</span>
<a id="ln-489" name="ln-489"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_MINCONN</span><span class="err">`</span>
<a id="ln-490" name="ln-490"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_CONTIG</span><span class="err">`</span>
<a id="ln-491" name="ln-491"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_SEED</span><span class="err">`</span>
<a id="ln-492" name="ln-492"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NUMBERING</span><span class="err">`</span>
<a id="ln-493" name="ln-493"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_DBGLVL</span><span class="err">`</span>
<a id="ln-494" name="ln-494"></a><span class="err">!</span>
<a id="ln-495" name="ln-495"></a><span class="err">!</span> <span class="n">OPTIONAL</span> <span class="err">::</span> <span class="n">VWGT</span><span class="p">,</span> <span class="n">VSIZE</span><span class="p">,</span> <span class="n">ADJWGT</span><span class="p">,</span> <span class="n">TPWGTS</span><span class="p">,</span> <span class="n">UBVEC</span><span class="p">,</span> <span class="n">OPTIONS</span>
<a id="ln-496" name="ln-496"></a><span class="err">!</span>
<a id="ln-497" name="ln-497"></a><span class="err">!</span> <span class="n">int_METIS_PartGraphRecursive</span><span class="p">(</span><span class="n">idx_t</span> <span class="o">*</span><span class="n">nvtxs</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">ncon</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">xadj</span><span class="p">,</span> <span class="n">idx_t</span> <span class="err">!</span> <span class="o">*</span><span class="n">adjncy</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">vwgt</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">vsize</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">adjwgt</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">nparts</span><span class="p">,</span> <span class="n">real_t</span> <span class="o">*</span><span class="n">tpwgts</span><span class="p">,</span> <span class="n">real_t</span> <span class="o">*</span><span class="n">ubvec</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">options</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">objval</span><span class="p">,</span> <span class="n">idx_t</span> <span class="o">*</span><span class="n">part</span><span class="p">)</span>
<a id="ln-498" name="ln-498"></a>
<a id="ln-499" name="ln-499"></a><span class="n">INTERFACE</span>
<a id="ln-500" name="ln-500"></a><span class="n">FUNCTION</span> <span class="n">METIS_PartGraphKway</span><span class="p">(</span> <span class="n">nvtxs</span><span class="p">,</span> <span class="n">ncon</span><span class="p">,</span> <span class="n">xadj</span><span class="p">,</span> <span class="n">adjncy</span><span class="p">,</span> <span class="err">&amp;</span>
<a id="ln-501" name="ln-501"></a>  <span class="err">&amp;</span> <span class="n">vwgt</span><span class="p">,</span> <span class="n">vsize</span><span class="p">,</span> <span class="n">adjwgt</span><span class="p">,</span> <span class="n">nparts</span><span class="p">,</span> <span class="n">tpwgts</span><span class="p">,</span> <span class="n">ubvec</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">objval</span><span class="p">,</span> <span class="n">part</span> <span class="p">)</span> <span class="err">&amp;</span>
<a id="ln-502" name="ln-502"></a>  <span class="err">&amp;</span> <span class="n">RESULT</span><span class="p">(</span> <span class="n">Ans</span> <span class="p">)</span> <span class="n">BIND</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;METIS_PartGraphKway&quot;</span> <span class="p">)</span>
<a id="ln-503" name="ln-503"></a>  <span class="n">IMPORT</span>
<a id="ln-504" name="ln-504"></a>
<a id="ln-505" name="ln-505"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nvtxs</span>
<a id="ln-506" name="ln-506"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">vertices</span> <span class="n">in</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-507" name="ln-507"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">ncon</span>
<a id="ln-508" name="ln-508"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">balancing</span> <span class="n">constraints</span> <span class="k">on</span> <span class="n">each</span> <span class="n">node</span><span class="err">.</span>
<a id="ln-509" name="ln-509"></a>    <span class="err">!!</span> <span class="n">It</span> <span class="n">should</span> <span class="n">be</span> <span class="n">atleast</span> <span class="mf">1.</span>
<a id="ln-510" name="ln-510"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">xadj</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">adjncy</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="ln-511" name="ln-511"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span>
<a id="ln-512" name="ln-512"></a>    <span class="err">!!</span> <span class="n">section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-513" name="ln-513"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-514" name="ln-514"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">vwgt</span>
<a id="ln-515" name="ln-515"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-516" name="ln-516"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-517" name="ln-517"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">vsize</span>
<a id="ln-518" name="ln-518"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">for</span> <span class="n">computing</span> <span class="n">the</span> <span class="n">total</span> <span class="n">communication</span> <span class="n">volume</span>
<a id="ln-519" name="ln-519"></a>    <span class="err">!!</span>  <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">section</span> <span class="mf">5.7</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-520" name="ln-520"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-521" name="ln-521"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">adjwgt</span>
<a id="ln-522" name="ln-522"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">edges</span> <span class="n">as</span> <span class="n">describe</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span>
<a id="ln-523" name="ln-523"></a>    <span class="err">!!</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-524" name="ln-524"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nparts</span>
<a id="ln-525" name="ln-525"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">parts</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-526" name="ln-526"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">tpwgts</span>
<a id="ln-527" name="ln-527"></a>    <span class="err">!!</span> <span class="n">This</span> <span class="n">is</span> <span class="n">an</span> <span class="n">array</span> <span class="n">pf</span> <span class="n">size</span><span class="err">`</span><span class="n">nparts</span><span class="o">*</span><span class="n">ncon</span><span class="err">`</span> <span class="n">that</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">desired</span>
<a id="ln-528" name="ln-528"></a>    <span class="err">!!</span> <span class="n">weight</span> <span class="n">for</span> <span class="n">each</span> <span class="n">partition</span> <span class="n">and</span> <span class="n">constraint</span><span class="err">.</span>
<a id="ln-529" name="ln-529"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">target</span> <span class="n">partition</span> <span class="n">weight</span> <span class="n">for</span> <span class="n">the</span> <span class="n">ith</span> <span class="n">partition</span> <span class="n">and</span>
<a id="ln-530" name="ln-530"></a>    <span class="err">!!</span> <span class="n">jth</span> <span class="n">constraint</span> <span class="n">is</span> <span class="n">specified</span> <span class="n">at</span> <span class="err">`</span><span class="n">tpwgts</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">ncon</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="err">`.</span>
<a id="ln-531" name="ln-531"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">for</span> <span class="n">both</span> <span class="n">partition</span> <span class="n">and</span> <span class="n">constraints</span> <span class="n">starts</span> <span class="n">from</span> <span class="mf">0.</span>
<a id="ln-532" name="ln-532"></a>    <span class="err">!!</span> <span class="n">For</span> <span class="n">each</span> <span class="n">constraint</span><span class="p">,</span> <span class="n">the</span> <span class="n">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="err">`</span><span class="n">tpwgts</span><span class="p">[]</span><span class="err">`</span> <span class="n">entries</span> <span class="n">must</span> <span class="n">be</span> <span class="mf">1.0</span><span class="err">.</span>
<a id="ln-533" name="ln-533"></a>    <span class="err">!!</span> <span class="n">If</span> <span class="n">not</span> <span class="n">present</span><span class="p">,</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">is</span> <span class="n">divided</span> <span class="n">equally</span> <span class="n">among</span> <span class="n">the</span> <span class="n">partitions</span><span class="err">.</span>
<a id="ln-534" name="ln-534"></a>    <span class="err">!!</span> <span class="n">More</span> <span class="n">in</span> <span class="n">the</span> <span class="n">description</span><span class="err">.</span>
<a id="ln-535" name="ln-535"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ubvec</span>
<a id="ln-536" name="ln-536"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">ncon</span><span class="err">`</span> <span class="n">that</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">allowed</span> <span class="n">load</span> <span class="n">imbalance</span>
<a id="ln-537" name="ln-537"></a>    <span class="err">!!</span> <span class="n">for</span> <span class="n">each</span> <span class="n">constraint</span><span class="err">.</span>
<a id="ln-538" name="ln-538"></a>    <span class="err">!!</span> <span class="n">For</span> <span class="n">the</span> <span class="err">`</span><span class="n">i</span><span class="err">`</span><span class="o">-</span><span class="n">th</span> <span class="n">partition</span> <span class="n">and</span> <span class="err">`</span><span class="n">j</span><span class="err">`</span><span class="o">-</span><span class="n">th</span> <span class="n">constraint</span> <span class="n">the</span> <span class="n">allowed</span>
<a id="ln-539" name="ln-539"></a>    <span class="err">!!</span> <span class="n">weight</span> <span class="n">is</span> <span class="n">the</span> <span class="err">`</span><span class="n">ubvec</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">tpwgts</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">ncon</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="err">`</span>
<a id="ln-540" name="ln-540"></a>    <span class="err">!!</span> <span class="n">fraction</span> <span class="n">of</span> <span class="n">the</span> <span class="err">`</span><span class="n">j</span><span class="err">`</span><span class="o">-</span><span class="n">th</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">constraint</span> <span class="n">total</span> <span class="n">weight</span><span class="err">.</span>
<a id="ln-541" name="ln-541"></a>    <span class="err">!!</span> <span class="n">If</span> <span class="n">not</span> <span class="n">present</span><span class="p">,</span> <span class="n">the</span> <span class="n">load</span> <span class="n">imbalance</span>
<a id="ln-542" name="ln-542"></a>    <span class="err">!!</span> <span class="n">tolerance</span> <span class="n">is</span> <span class="mf">1.001</span> <span class="p">(</span><span class="n">for</span> <span class="err">`</span><span class="n">ncon</span> <span class="o">=</span> <span class="mi">1</span><span class="err">`</span><span class="p">)</span> <span class="n">or</span> <span class="mf">1.01</span> <span class="p">(</span><span class="n">for</span> <span class="err">`</span><span class="n">ncon</span> <span class="p">&gt;</span> <span class="mi">1</span><span class="err">`</span><span class="p">)</span><span class="err">.</span>
<a id="ln-543" name="ln-543"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">options</span>
<a id="ln-544" name="ln-544"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">options</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.4</span> <span class="n">of</span> <span class="n">the</span> <span class="n">METIS</span> <span class="n">manual</span><span class="err">.</span>
<a id="ln-545" name="ln-545"></a>    <span class="err">!!</span> <span class="n">See</span> <span class="n">description</span> <span class="n">for</span> <span class="n">valid</span> <span class="n">options</span><span class="err">.</span>
<a id="ln-546" name="ln-546"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">objval</span>
<a id="ln-547" name="ln-547"></a>    <span class="err">!!</span> <span class="n">Upon</span> <span class="n">successful</span> <span class="n">completion</span><span class="p">,</span> <span class="n">this</span> <span class="n">variable</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">edge</span><span class="o">-</span><span class="n">cut</span> <span class="n">or</span> <span class="n">the</span>
<a id="ln-548" name="ln-548"></a>    <span class="err">!!</span> <span class="n">total</span> <span class="n">communication</span> <span class="n">volume</span> <span class="n">of</span> <span class="n">the</span> <span class="n">partitioning</span>
<a id="ln-549" name="ln-549"></a>    <span class="err">!!</span> <span class="n">solution</span><span class="err">.</span> <span class="n">The</span> <span class="n">value</span> <span class="n">returned</span> <span class="n">depends</span> <span class="k">on</span> <span class="n">the</span> <span class="n">partitioning</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">objective</span>
<a id="ln-550" name="ln-550"></a>    <span class="err">!!</span> <span class="n">function</span><span class="err">.</span>
<a id="ln-551" name="ln-551"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">part</span><span class="p">(</span><span class="n">nvtxs</span><span class="p">)</span>
<a id="ln-552" name="ln-552"></a>    <span class="err">!!</span> <span class="n">This</span> <span class="n">is</span> <span class="n">a</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nvtxs</span><span class="err">`</span> <span class="n">that</span> <span class="n">upon</span> <span class="n">successful</span> <span class="n">completion</span>
<a id="ln-553" name="ln-553"></a>    <span class="err">!!</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">partition</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">the</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-554" name="ln-554"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span>
<a id="ln-555" name="ln-555"></a>    <span class="err">!!</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="err">`</span><span class="n">options</span><span class="p">(</span><span class="n">METIS_OPTION_NUMBERING</span><span class="p">)</span><span class="err">`.</span>
<a id="ln-556" name="ln-556"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-557" name="ln-557"></a>    <span class="err">!!</span> <span class="n">Error</span> <span class="n">code</span>
<a id="ln-558" name="ln-558"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span>
<a id="ln-559" name="ln-559"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_INPUT</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">an</span> <span class="n">input</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-560" name="ln-560"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_MEMORY</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">it</span> <span class="n">could</span> <span class="n">not</span> <span class="n">allocate</span> <span class="n">the</span> <span class="n">required</span> <span class="n">memory</span><span class="err">.</span>
<a id="ln-561" name="ln-561"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">some</span> <span class="n">other</span> <span class="k">type</span> <span class="n">of</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-562" name="ln-562"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_PartGraphKway</span>
<a id="ln-563" name="ln-563"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-564" name="ln-564"></a>
<a id="ln-565" name="ln-565"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PartGraphKway</span>
<a id="ln-566" name="ln-566"></a>
<a id="ln-567" name="ln-567"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-568" name="ln-568"></a><span class="err">!</span>                                                       <span class="n">METIS_PartMeshDual</span>
<a id="ln-569" name="ln-569"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-570" name="ln-570"></a>
<a id="ln-571" name="ln-571"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-572" name="ln-572"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">27</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-573" name="ln-573"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="nb">mesh</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">parts</span> <span class="n">based</span> <span class="k">on</span> <span class="n">a</span> <span class="n">partitioning</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-574" name="ln-574"></a><span class="err">!</span>
<a id="ln-575" name="ln-575"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-576" name="ln-576"></a><span class="err">!</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="nb">mesh</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">parts</span> <span class="n">based</span> <span class="k">on</span> <span class="n">a</span> <span class="n">partitioning</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-577" name="ln-577"></a><span class="err">!</span>
<a id="ln-578" name="ln-578"></a><span class="err">!</span> <span class="n">This</span> <span class="n">program</span> <span class="n">first</span> <span class="n">converts</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">into</span> <span class="n">either</span> <span class="n">a</span> <span class="n">dual</span> <span class="n">graph</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span> <span class="n">each</span> <span class="n">element</span> <span class="n">becomes</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">vertex</span><span class="p">)</span> <span class="n">or</span> <span class="n">a</span> <span class="n">nodal</span> <span class="n">graph</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span> <span class="n">each</span> <span class="n">node</span> <span class="n">becomes</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">vertex</span><span class="p">),</span> <span class="n">and</span> <span class="n">then</span> <span class="n">uses</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">partitioning</span> <span class="n">API</span> <span class="n">routines</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">this</span> <span class="n">graph</span><span class="err">.</span> <span class="n">METIS</span> <span class="n">utilizes</span> <span class="n">a</span> <span class="n">flexible</span> <span class="n">approach</span> <span class="n">for</span> <span class="n">creating</span> <span class="n">a</span> <span class="n">graph</span> <span class="n">for</span> <span class="n">a</span> <span class="n">finite</span> <span class="n">element</span> <span class="nb">mesh</span><span class="p">,</span> <span class="n">which</span> <span class="n">allows</span> <span class="n">it</span> <span class="n">to</span> <span class="n">handle</span> <span class="n">meshes</span> <span class="n">with</span> <span class="n">different</span> <span class="n">and</span> <span class="n">possibly</span> <span class="n">mixed</span> <span class="n">element</span> <span class="n">types</span> <span class="p">(</span><span class="n">e</span><span class="err">.</span><span class="n">g</span><span class="err">.</span><span class="p">,</span> <span class="n">triangles</span><span class="p">,</span> <span class="n">tetrahedra</span><span class="p">,</span> <span class="n">hexahedra</span><span class="p">,</span> <span class="n">etc</span><span class="err">.</span><span class="p">)</span><span class="err">.</span> <span class="n">The</span> <span class="n">functionality</span> <span class="n">provided</span> <span class="n">by</span> <span class="n">mpmetis</span> <span class="n">is</span> <span class="n">achieved</span> <span class="n">by</span> <span class="n">the</span> <span class="n">METIS</span> <span class="n">PartMeshNodal</span> <span class="n">and</span> <span class="n">METIS</span> <span class="n">PartMeshDual</span> <span class="n">API</span> <span class="n">routines</span>
<a id="ln-579" name="ln-579"></a><span class="err">!</span>
<a id="ln-580" name="ln-580"></a><span class="err">!</span> <span class="n">THE</span> <span class="n">FOLLOWING</span> <span class="n">OPTIONS</span> <span class="n">ARE</span> <span class="n">VALID</span>
<a id="ln-581" name="ln-581"></a><span class="err">!</span>
<a id="ln-582" name="ln-582"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_PTYPE</span><span class="err">`</span>
<a id="ln-583" name="ln-583"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_OBJTYPE</span><span class="err">`</span>
<a id="ln-584" name="ln-584"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_CTYPE</span><span class="err">`</span><span class="p">,</span>
<a id="ln-585" name="ln-585"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_IPTYPE</span><span class="err">`</span>
<a id="ln-586" name="ln-586"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_RTYPE</span><span class="err">`</span>
<a id="ln-587" name="ln-587"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NCUTS</span><span class="err">`</span><span class="p">,</span>
<a id="ln-588" name="ln-588"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NITER</span><span class="err">`</span>
<a id="ln-589" name="ln-589"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_SEED</span><span class="err">`</span>
<a id="ln-590" name="ln-590"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_UFACTOR</span><span class="err">`</span><span class="p">,</span>
<a id="ln-591" name="ln-591"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NUMBERING</span><span class="err">`</span>
<a id="ln-592" name="ln-592"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_DBGLVL</span><span class="err">`</span>
<a id="ln-593" name="ln-593"></a><span class="err">!</span>
<a id="ln-594" name="ln-594"></a><span class="err">!</span> <span class="n">OPTIONAL</span> <span class="err">:</span> <span class="n">VWGT</span><span class="p">,</span> <span class="n">VSIZE</span><span class="p">,</span> <span class="n">TPWGTS</span><span class="p">,</span> <span class="n">OPTIONS</span>
<a id="ln-595" name="ln-595"></a><span class="err">!</span>
<a id="ln-596" name="ln-596"></a><span class="err">!</span> <span class="n">MESH</span> <span class="n">DATA</span> <span class="n">STRUCTURE</span>
<a id="ln-597" name="ln-597"></a><span class="err">!</span>
<a id="ln-598" name="ln-598"></a><span class="err">!</span> <span class="n">All</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">partitioning</span> <span class="n">and</span> <span class="nb">mesh</span> <span class="n">conversion</span> <span class="n">routines</span> <span class="n">in</span> <span class="n">METIS</span> <span class="n">take</span> <span class="n">as</span> <span class="n">input</span> <span class="n">the</span> <span class="n">element</span> <span class="n">node</span> <span class="n">array</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">This</span> <span class="n">element</span> <span class="n">node</span> <span class="n">array</span> <span class="n">is</span> <span class="n">stored</span> <span class="n">using</span> <span class="n">a</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">arrays</span> <span class="n">called</span> <span class="n">eptr</span> <span class="n">and</span> <span class="n">eind</span><span class="p">,</span> <span class="n">which</span> <span class="n">are</span> <span class="n">similar</span> <span class="n">to</span> <span class="n">the</span> <span class="n">xadj</span> <span class="n">and</span> <span class="n">adjncy</span> <span class="n">arrays</span> <span class="n">used</span> <span class="n">for</span> <span class="n">storing</span> <span class="n">the</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">a</span> <span class="n">graph</span><span class="err">.</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">eptr</span> <span class="n">array</span> <span class="n">is</span> <span class="n">n</span><span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span> <span class="n">n</span> <span class="n">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">elements</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">eind</span> <span class="n">array</span> <span class="n">is</span> <span class="n">of</span> <span class="n">size</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">the</span> <span class="n">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">in</span> <span class="k">all</span> <span class="n">the</span> <span class="n">elements</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">list</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">belonging</span> <span class="n">to</span> <span class="n">the</span> <span class="n">ith</span> <span class="n">element</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">are</span> <span class="n">stored</span> <span class="n">in</span> <span class="n">consecutive</span> <span class="n">locations</span> <span class="n">of</span> <span class="n">eind</span> <span class="n">starting</span> <span class="n">at</span> <span class="n">position</span> <span class="n">eptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">up</span> <span class="n">to</span> <span class="p">(</span><span class="n">but</span> <span class="n">not</span> <span class="n">including</span><span class="p">)</span> <span class="n">position</span> <span class="n">eptr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="err">.</span> <span class="n">This</span> <span class="n">format</span> <span class="n">makes</span> <span class="n">it</span> <span class="n">easy</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">meshes</span> <span class="n">of</span> <span class="n">any</span> <span class="k">type</span> <span class="n">of</span> <span class="n">elements</span><span class="p">,</span> <span class="n">including</span> <span class="n">meshes</span> <span class="n">with</span> <span class="n">mixed</span> <span class="n">element</span> <span class="n">types</span> <span class="n">that</span> <span class="n">have</span> <span class="n">different</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">per</span> <span class="n">element</span><span class="err">.</span> <span class="n">As</span> <span class="n">it</span> <span class="n">was</span> <span class="n">the</span> <span class="k">case</span> <span class="n">with</span> <span class="n">the</span> <span class="n">format</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">file</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">4.1.2</span><span class="p">,</span> <span class="n">the</span> <span class="n">ordering</span> <span class="n">of</span> <span class="n">the</span> <span class="n">nodes</span> <span class="n">in</span> <span class="n">each</span> <span class="n">element</span> <span class="n">is</span> <span class="n">not</span> <span class="n">important</span>
<a id="ln-599" name="ln-599"></a>
<a id="ln-600" name="ln-600"></a><span class="n">INTERFACE</span>
<a id="ln-601" name="ln-601"></a><span class="n">FUNCTION</span> <span class="n">METIS_PartMeshDual</span> <span class="p">(</span> <span class="n">ne</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">eptr</span><span class="p">,</span><span class="n">eind</span><span class="p">,</span><span class="n">vwgt</span><span class="p">,</span><span class="n">vsize</span><span class="p">,</span><span class="n">ncommon</span><span class="p">,</span> <span class="err">&amp;</span>
<a id="ln-602" name="ln-602"></a>  <span class="err">&amp;</span> <span class="n">nparts</span><span class="p">,</span><span class="n">tpwgts</span><span class="p">,</span><span class="n">options</span><span class="p">,</span><span class="n">objval</span><span class="p">,</span><span class="n">epart</span><span class="p">,</span><span class="n">npart</span> <span class="p">)</span> <span class="err">&amp;</span>
<a id="ln-603" name="ln-603"></a>  <span class="err">&amp;</span> <span class="n">RESULT</span><span class="p">(</span> <span class="n">Ans</span> <span class="p">)</span> <span class="n">BIND</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;METIS_PartMeshDual&quot;</span><span class="p">)</span>
<a id="ln-604" name="ln-604"></a>  <span class="n">IMPORT</span>
<a id="ln-605" name="ln-605"></a>
<a id="ln-606" name="ln-606"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">ne</span>
<a id="ln-607" name="ln-607"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">elements</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-608" name="ln-608"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nn</span>
<a id="ln-609" name="ln-609"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-610" name="ln-610"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">eptr</span><span class="p">(</span> <span class="o">*</span> <span class="p">),</span> <span class="n">eind</span><span class="p">(</span> <span class="o">*</span> <span class="p">)</span>
<a id="ln-611" name="ln-611"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">arrays</span> <span class="n">storing</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.6</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-612" name="ln-612"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">vwgt</span>
<a id="ln-613" name="ln-613"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">ne</span><span class="err">`</span> <span class="n">specifying</span> <span class="n">the</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">elements</span><span class="err">.</span> <span class="n">If</span> <span class="n">not</span> <span class="n">present</span><span class="p">,</span> <span class="k">all</span> <span class="n">elements</span> <span class="n">have</span> <span class="n">an</span> <span class="n">equal</span> <span class="n">weight</span><span class="err">.</span>
<a id="ln-614" name="ln-614"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">vsize</span>
<a id="ln-615" name="ln-615"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">ne</span><span class="err">`</span> <span class="n">specifying</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">elements</span> <span class="n">that</span> <span class="n">is</span> <span class="n">used</span>
<a id="ln-616" name="ln-616"></a>    <span class="err">!!</span> <span class="n">for</span> <span class="n">computing</span> <span class="n">the</span> <span class="n">total</span> <span class="n">comunication</span> <span class="n">volume</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.7</span> <span class="n">of</span> <span class="n">the</span>  <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-617" name="ln-617"></a>    <span class="err">!!</span> <span class="n">If</span> <span class="n">not</span> <span class="n">present</span><span class="p">,</span> <span class="n">the</span> <span class="n">objective</span> <span class="n">is</span> <span class="n">cut</span> <span class="n">or</span> <span class="k">all</span> <span class="n">elements</span> <span class="n">have</span> <span class="n">an</span> <span class="n">equal</span> <span class="n">size</span><span class="err">.</span>
<a id="ln-618" name="ln-618"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">ncommon</span>
<a id="ln-619" name="ln-619"></a>    <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">common</span> <span class="n">nodes</span> <span class="n">that</span> <span class="n">two</span> <span class="n">elements</span> <span class="n">must</span> <span class="n">have</span> <span class="n">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">put</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">between</span> <span class="n">them</span> <span class="n">in</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">.</span> <span class="n">Given</span> <span class="n">two</span> <span class="n">elements</span> <span class="n">e1</span> <span class="n">and</span> <span class="n">e2</span><span class="p">,</span> <span class="n">containing</span> <span class="n">n1</span> <span class="n">and</span> <span class="n">n2</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">respectively</span><span class="p">,</span> <span class="n">then</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">will</span> <span class="n">connect</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">in</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">e1</span> <span class="n">and</span> <span class="n">e2</span> <span class="k">if</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">common</span> <span class="n">nodes</span> <span class="n">between</span> <span class="n">them</span> <span class="n">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">or</span> <span class="n">equal</span> <span class="n">to</span> <span class="k">min</span><span class="p">(</span><span class="n">ncommon</span><span class="p">;</span> <span class="n">n1</span> <span class="err">−</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n2</span> <span class="err">−</span> <span class="mi">1</span><span class="p">)</span><span class="err">.</span> <span class="n">The</span> <span class="k">default</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">1</span><span class="p">,</span> <span class="n">indicating</span> <span class="n">that</span> <span class="n">two</span> <span class="n">elements</span> <span class="n">will</span> <span class="n">be</span> <span class="n">connected</span> <span class="n">via</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">as</span> <span class="n">long</span> <span class="n">as</span> <span class="n">they</span> <span class="n">share</span> <span class="n">one</span> <span class="n">node</span><span class="err">.</span> <span class="n">However</span><span class="p">,</span> <span class="n">this</span> <span class="n">will</span> <span class="n">tend</span> <span class="n">to</span> <span class="n">create</span> <span class="n">too</span> <span class="n">many</span> <span class="n">edges</span> <span class="p">(</span><span class="n">increasing</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">and</span> <span class="n">time</span> <span class="n">requirements</span> <span class="n">of</span> <span class="n">the</span> <span class="n">partitioning</span><span class="p">)</span><span class="err">.</span> <span class="n">The</span> <span class="n">user</span> <span class="n">should</span> <span class="n">select</span> <span class="n">higher</span> <span class="n">values</span> <span class="n">that</span> <span class="n">are</span> <span class="n">better</span> <span class="n">suited</span> <span class="n">for</span> <span class="n">the</span> <span class="n">element</span> <span class="n">types</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">that</span> <span class="n">wants</span> <span class="n">to</span> <span class="n">partition</span><span class="err">.</span> <span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">for</span> <span class="n">tetrahedron</span> <span class="n">meshes</span><span class="p">,</span> <span class="n">ncommon</span> <span class="n">should</span> <span class="n">be</span> <span class="mi">3</span><span class="p">,</span> <span class="n">which</span> <span class="n">creates</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">between</span> <span class="n">two</span> <span class="n">tets</span> <span class="n">when</span> <span class="n">they</span> <span class="n">share</span> <span class="n">a</span> <span class="n">triangular</span> <span class="n">face</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span> <span class="mi">3</span> <span class="n">nodes</span><span class="p">)</span>
<a id="ln-620" name="ln-620"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nparts</span>
<a id="ln-621" name="ln-621"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">parts</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-622" name="ln-622"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">tpwgts</span>
<a id="ln-623" name="ln-623"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">that</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">desired</span> <span class="n">weight</span> <span class="n">for</span> <span class="n">each</span> <span class="n">partition</span><span class="err">.</span> <span class="n">The</span> <span class="o">*</span><span class="n">target</span> <span class="n">partition</span> <span class="n">weight</span><span class="o">*</span> <span class="n">for</span> <span class="n">the</span> <span class="err">`</span><span class="n">i</span><span class="err">`</span><span class="o">-</span><span class="n">th</span> <span class="n">partition</span> <span class="n">is</span> <span class="n">specified</span> <span class="n">at</span> <span class="err">`</span><span class="n">tpwgts</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">`</span> <span class="p">(</span><span class="n">the</span> <span class="n">numbering</span> <span class="n">for</span> <span class="n">the</span>
<a id="ln-624" name="ln-624"></a>    <span class="err">!!</span> <span class="n">partitions</span> <span class="n">starts</span> <span class="n">from</span> <span class="mi">0</span><span class="p">)</span><span class="err">.</span> <span class="n">The</span> <span class="n">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="err">`</span><span class="n">tpwgts</span><span class="err">`</span> <span class="n">entries</span> <span class="n">must</span> <span class="n">be</span> <span class="mf">1.0</span><span class="err">.</span>
<a id="ln-625" name="ln-625"></a>    <span class="err">!!</span> <span class="n">If</span> <span class="n">not</span> <span class="n">present</span><span class="p">,</span> <span class="n">the</span> <span class="n">graph</span> <span class="n">is</span> <span class="n">divided</span> <span class="n">equally</span> <span class="n">among</span> <span class="n">the</span> <span class="n">partitions</span><span class="err">.</span>
<a id="ln-626" name="ln-626"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">options</span>
<a id="ln-627" name="ln-627"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">options</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.4</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf). See description for valid options.</span>
<a id="ln-628" name="ln-628"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">objval</span>
<a id="ln-629" name="ln-629"></a>    <span class="err">!!</span> <span class="n">Upon</span> <span class="n">successful</span> <span class="n">completion</span><span class="p">,</span> <span class="n">this</span> <span class="n">variable</span> <span class="n">stores</span> <span class="n">either</span> <span class="n">the</span> <span class="n">edgecut</span> <span class="n">or</span> <span class="n">the</span> <span class="n">total</span> <span class="n">communication</span>
<a id="ln-630" name="ln-630"></a>    <span class="err">!!</span> <span class="n">volume</span> <span class="n">of</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">partitioning</span><span class="err">.</span>
<a id="ln-631" name="ln-631"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">epart</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span>
<a id="ln-632" name="ln-632"></a>    <span class="err">!!</span> <span class="n">A</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">ne</span><span class="err">`</span> <span class="n">that</span> <span class="n">upon</span> <span class="n">successful</span> <span class="n">completion</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">partition</span> <span class="n">vector</span> <span class="n">for</span> <span class="n">the</span> <span class="n">elements</span>
<a id="ln-633" name="ln-633"></a>    <span class="err">!!</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span>
<a id="ln-634" name="ln-634"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">options</span><span class="p">(</span><span class="n">METIS_OPTION_NUMBERING</span><span class="p">)</span><span class="err">`.</span>
<a id="ln-635" name="ln-635"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">npart</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
<a id="ln-636" name="ln-636"></a>    <span class="err">!!</span> <span class="n">A</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nn</span><span class="err">`</span> <span class="n">that</span> <span class="n">upon</span> <span class="n">successful</span> <span class="n">completion</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">partition</span> <span class="n">vector</span> <span class="n">for</span> <span class="n">the</span> <span class="n">nodes</span>
<a id="ln-637" name="ln-637"></a>    <span class="err">!!</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span>
<a id="ln-638" name="ln-638"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">options</span><span class="p">(</span><span class="n">METIS_OPTION_NUMBERING</span><span class="p">)</span><span class="err">`.</span>
<a id="ln-639" name="ln-639"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-640" name="ln-640"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-641" name="ln-641"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_INPUT</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">an</span> <span class="n">input</span> <span class="k">error</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-642" name="ln-642"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_MEMORY</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">it</span> <span class="n">could</span> <span class="n">not</span> <span class="n">allocate</span> <span class="n">the</span> <span class="n">required</span> <span class="n">memory</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-643" name="ln-643"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">some</span> <span class="n">other</span> <span class="k">type</span> <span class="n">of</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-644" name="ln-644"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_PartMeshDual</span>
<a id="ln-645" name="ln-645"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-646" name="ln-646"></a>
<a id="ln-647" name="ln-647"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PartMeshDual</span>
<a id="ln-648" name="ln-648"></a>
<a id="ln-649" name="ln-649"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-650" name="ln-650"></a><span class="err">!</span>                                                        <span class="n">METIS_PartMeshNodal</span>
<a id="ln-651" name="ln-651"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-652" name="ln-652"></a>
<a id="ln-653" name="ln-653"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-654" name="ln-654"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">28</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-655" name="ln-655"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> <span class="n">This</span> <span class="n">function</span> <span class="n">us</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="nb">mesh</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">parts</span> <span class="n">based</span> <span class="k">on</span> <span class="n">a</span> <span class="n">partitioning</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">nodal</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-656" name="ln-656"></a><span class="err">!</span>
<a id="ln-657" name="ln-657"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-658" name="ln-658"></a><span class="err">!</span> <span class="n">This</span> <span class="n">function</span> <span class="n">us</span> <span class="n">used</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">a</span> <span class="nb">mesh</span> <span class="n">into</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">parts</span> <span class="n">based</span> <span class="k">on</span> <span class="n">a</span>
<a id="ln-659" name="ln-659"></a><span class="err">!</span>  <span class="n">partitioning</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">nodal</span> <span class="n">graph</span><span class="err">.</span>
<a id="ln-660" name="ln-660"></a><span class="err">!</span>
<a id="ln-661" name="ln-661"></a><span class="err">!</span> <span class="n">THE</span> <span class="n">FOLLOWING</span> <span class="n">OPTIONS</span> <span class="n">ARE</span> <span class="n">VALID</span><span class="err">:</span>
<a id="ln-662" name="ln-662"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_PTYPE</span><span class="err">`</span>
<a id="ln-663" name="ln-663"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_OBJTYPE</span><span class="err">`</span>
<a id="ln-664" name="ln-664"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_CTYPE</span><span class="err">`</span>
<a id="ln-665" name="ln-665"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_IPTYPE</span><span class="err">`</span>
<a id="ln-666" name="ln-666"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_RTYPE</span><span class="err">`</span>
<a id="ln-667" name="ln-667"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NCUTS</span><span class="err">`</span><span class="p">,</span>
<a id="ln-668" name="ln-668"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NITER</span><span class="err">`</span>
<a id="ln-669" name="ln-669"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_SEED</span><span class="err">`</span>
<a id="ln-670" name="ln-670"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_UFACTOR</span><span class="err">`</span><span class="p">,</span>
<a id="ln-671" name="ln-671"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_NUMBERING</span><span class="err">`</span>
<a id="ln-672" name="ln-672"></a><span class="err">!</span> <span class="o">-</span> <span class="err">`</span><span class="n">METIS_OPTION_DBGLVL</span><span class="err">`</span>
<a id="ln-673" name="ln-673"></a><span class="err">!</span>
<a id="ln-674" name="ln-674"></a><span class="err">!</span>
<a id="ln-675" name="ln-675"></a><span class="err">!</span> <span class="n">MESH</span> <span class="n">DATA</span> <span class="n">STRUCTURE</span>
<a id="ln-676" name="ln-676"></a><span class="err">!</span>
<a id="ln-677" name="ln-677"></a><span class="err">!</span> <span class="n">All</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">partitioning</span> <span class="n">and</span> <span class="nb">mesh</span> <span class="n">conversion</span> <span class="n">routines</span> <span class="n">in</span> <span class="n">METIS</span> <span class="n">take</span> <span class="n">as</span> <span class="n">input</span> <span class="n">the</span> <span class="n">element</span> <span class="n">node</span> <span class="n">array</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">This</span> <span class="n">element</span> <span class="n">node</span> <span class="n">array</span> <span class="n">is</span> <span class="n">stored</span> <span class="n">using</span> <span class="n">a</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">arrays</span> <span class="n">called</span> <span class="n">eptr</span> <span class="n">and</span> <span class="n">eind</span><span class="p">,</span> <span class="n">which</span> <span class="n">are</span> <span class="n">similar</span> <span class="n">to</span> <span class="n">the</span> <span class="n">xadj</span> <span class="n">and</span> <span class="n">adjncy</span> <span class="n">arrays</span> <span class="n">used</span> <span class="n">for</span> <span class="n">storing</span> <span class="n">the</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">a</span> <span class="n">graph</span><span class="err">.</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">eptr</span> <span class="n">array</span> <span class="n">is</span> <span class="n">n</span><span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">where</span> <span class="n">n</span> <span class="n">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">elements</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">eind</span> <span class="n">array</span> <span class="n">is</span> <span class="n">of</span> <span class="n">size</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">the</span> <span class="n">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">in</span> <span class="k">all</span> <span class="n">the</span> <span class="n">elements</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">list</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">belonging</span> <span class="n">to</span> <span class="n">the</span> <span class="n">ith</span> <span class="n">element</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">are</span> <span class="n">stored</span> <span class="n">in</span> <span class="n">consecutive</span> <span class="n">locations</span> <span class="n">of</span> <span class="n">eind</span> <span class="n">starting</span> <span class="n">at</span> <span class="n">position</span> <span class="n">eptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">up</span> <span class="n">to</span> <span class="p">(</span><span class="n">but</span> <span class="n">not</span> <span class="n">including</span><span class="p">)</span> <span class="n">position</span> <span class="n">eptr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="err">.</span> <span class="n">This</span> <span class="n">format</span> <span class="n">makes</span> <span class="n">it</span> <span class="n">easy</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">meshes</span> <span class="n">of</span> <span class="n">any</span> <span class="k">type</span> <span class="n">of</span> <span class="n">elements</span><span class="p">,</span> <span class="n">including</span> <span class="n">meshes</span> <span class="n">with</span> <span class="n">mixed</span> <span class="n">element</span> <span class="n">types</span> <span class="n">that</span> <span class="n">have</span> <span class="n">different</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">per</span> <span class="n">element</span><span class="err">.</span> <span class="n">As</span> <span class="n">it</span> <span class="n">was</span> <span class="n">the</span> <span class="k">case</span> <span class="n">with</span> <span class="n">the</span> <span class="n">format</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">file</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">4.1.2</span><span class="p">,</span> <span class="n">the</span> <span class="n">ordering</span> <span class="n">of</span> <span class="n">the</span> <span class="n">nodes</span> <span class="n">in</span> <span class="n">each</span> <span class="n">element</span> <span class="n">is</span> <span class="n">not</span> <span class="n">important</span>
<a id="ln-678" name="ln-678"></a>
<a id="ln-679" name="ln-679"></a><span class="n">INTERFACE</span>
<a id="ln-680" name="ln-680"></a><span class="n">FUNCTION</span> <span class="n">METIS_PartMeshNodal</span><span class="p">(</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="n">eptr</span><span class="p">,</span> <span class="n">eind</span><span class="p">,</span> <span class="n">vwgt</span><span class="p">,</span> <span class="n">vsize</span><span class="p">,</span>  <span class="err">&amp;</span>
<a id="ln-681" name="ln-681"></a>  <span class="err">&amp;</span> <span class="n">nparts</span><span class="p">,</span> <span class="n">tpwgts</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">objval</span><span class="p">,</span> <span class="n">epart</span><span class="p">,</span> <span class="n">npart</span> <span class="p">)</span> <span class="err">&amp;</span>
<a id="ln-682" name="ln-682"></a>  <span class="err">&amp;</span> <span class="n">RESULT</span><span class="p">(</span> <span class="n">Ans</span> <span class="p">)</span> <span class="n">BIND</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;METIS_PartMeshNodal&quot;</span> <span class="p">)</span>
<a id="ln-683" name="ln-683"></a>  <span class="n">IMPORT</span>
<a id="ln-684" name="ln-684"></a>
<a id="ln-685" name="ln-685"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">ne</span>
<a id="ln-686" name="ln-686"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">elements</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-687" name="ln-687"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nn</span>
<a id="ln-688" name="ln-688"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-689" name="ln-689"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">eptr</span><span class="p">(</span> <span class="o">*</span> <span class="p">),</span> <span class="n">eind</span><span class="p">(</span> <span class="o">*</span> <span class="p">)</span>
<a id="ln-690" name="ln-690"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">arrays</span> <span class="n">storing</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.6</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-691" name="ln-691"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">vwgt</span>
<a id="ln-692" name="ln-692"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nn</span><span class="err">`</span> <span class="n">specifying</span> <span class="n">weights</span> <span class="n">of</span> <span class="n">the</span> <span class="n">nodes</span><span class="err">.</span> <span class="n">If</span> <span class="n">not</span> <span class="n">passed</span><span class="p">,</span> <span class="k">all</span> <span class="n">nodes</span> <span class="n">have</span> <span class="n">an</span> <span class="n">equal</span> <span class="n">weight</span><span class="err">.</span>
<a id="ln-693" name="ln-693"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">vsize</span>
<a id="ln-694" name="ln-694"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nn</span><span class="err">`</span> <span class="n">specifying</span> <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">nodes</span> <span class="n">that</span> <span class="n">is</span> <span class="n">used</span> <span class="n">for</span> <span class="n">computing</span> <span class="n">the</span>
<a id="ln-695" name="ln-695"></a>    <span class="err">!!</span> <span class="n">total</span> <span class="n">comunication</span> <span class="n">volume</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.7</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf). If not passed,</span>
<a id="ln-696" name="ln-696"></a>    <span class="err">!!</span> <span class="n">the</span> <span class="n">objective</span> <span class="n">is</span> <span class="n">cut</span> <span class="n">or</span> <span class="k">all</span> <span class="n">nodes</span> <span class="n">have</span> <span class="n">an</span> <span class="n">equal</span> <span class="n">size</span><span class="err">.</span>
<a id="ln-697" name="ln-697"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nparts</span>
<a id="ln-698" name="ln-698"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">parts</span> <span class="n">to</span> <span class="n">partition</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-699" name="ln-699"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">tpwgts</span>
<a id="ln-700" name="ln-700"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nparts</span><span class="err">`</span> <span class="n">that</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">desired</span> <span class="n">weight</span> <span class="n">for</span> <span class="n">each</span> <span class="n">partition</span><span class="err">.</span> <span class="n">The</span> <span class="o">*</span><span class="n">target</span>
<a id="ln-701" name="ln-701"></a>    <span class="err">!!</span> <span class="n">partition</span> <span class="n">weight</span><span class="o">*</span> <span class="n">for</span> <span class="n">the</span> <span class="err">`</span><span class="n">i</span><span class="err">`</span><span class="o">-</span><span class="n">th</span> <span class="n">partition</span> <span class="n">is</span> <span class="n">specified</span> <span class="n">at</span> <span class="err">`</span><span class="n">tpwgts</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="err">`</span> <span class="p">(</span><span class="n">the</span> <span class="n">numbering</span> <span class="n">for</span> <span class="n">the</span>
<a id="ln-702" name="ln-702"></a>    <span class="err">!!</span> <span class="n">partitions</span> <span class="n">starts</span> <span class="n">from</span> <span class="mi">0</span><span class="p">)</span><span class="err">.</span> <span class="n">The</span> <span class="n">sum</span> <span class="n">of</span> <span class="n">the</span> <span class="err">`</span><span class="n">tpwgts</span><span class="err">`</span> <span class="n">entries</span> <span class="n">must</span> <span class="n">be</span> <span class="mf">1.0</span><span class="err">.</span> <span class="n">If</span> <span class="n">not</span> <span class="n">passed</span><span class="p">,</span> <span class="n">the</span> <span class="n">graph</span>
<a id="ln-703" name="ln-703"></a>    <span class="err">!!</span> <span class="n">is</span> <span class="n">divided</span> <span class="n">equally</span> <span class="n">among</span> <span class="n">the</span> <span class="n">partitions</span><span class="err">.</span>
<a id="ln-704" name="ln-704"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span><span class="p">,</span> <span class="n">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span> <span class="err">::</span> <span class="n">options</span>
<a id="ln-705" name="ln-705"></a>    <span class="err">!!</span> <span class="n">An</span> <span class="n">array</span> <span class="n">of</span> <span class="n">options</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.4</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf). See description for valid options.</span>
<a id="ln-706" name="ln-706"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">objval</span>
<a id="ln-707" name="ln-707"></a>    <span class="err">!!</span> <span class="n">Upon</span> <span class="n">successful</span> <span class="n">completion</span><span class="p">,</span> <span class="n">this</span> <span class="n">variable</span> <span class="n">stores</span> <span class="n">either</span> <span class="n">the</span> <span class="n">edgecut</span> <span class="n">or</span> <span class="n">the</span> <span class="n">total</span> <span class="n">communication</span>
<a id="ln-708" name="ln-708"></a>    <span class="err">!!</span> <span class="n">volume</span> <span class="n">of</span> <span class="n">the</span> <span class="n">nodal</span> <span class="n">graph</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">partitioning</span><span class="err">.</span>
<a id="ln-709" name="ln-709"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">epart</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span>
<a id="ln-710" name="ln-710"></a>    <span class="err">!!</span> <span class="n">A</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">ne</span><span class="err">`</span> <span class="n">that</span> <span class="n">upon</span> <span class="n">successful</span> <span class="n">completion</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">partition</span> <span class="n">vector</span> <span class="n">for</span> <span class="n">the</span> <span class="n">elements</span>
<a id="ln-711" name="ln-711"></a>    <span class="err">!!</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span>
<a id="ln-712" name="ln-712"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">options</span><span class="p">(</span><span class="n">METIS_OPTION_NUMBERING</span><span class="p">)</span><span class="err">`.</span>
<a id="ln-713" name="ln-713"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">npart</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
<a id="ln-714" name="ln-714"></a>    <span class="err">!!</span> <span class="n">A</span> <span class="n">vector</span> <span class="n">of</span> <span class="n">size</span> <span class="err">`</span><span class="n">nn</span><span class="err">`</span> <span class="n">that</span> <span class="n">upon</span> <span class="n">successful</span> <span class="n">completion</span> <span class="n">stores</span> <span class="n">the</span> <span class="n">partition</span> <span class="n">vector</span> <span class="n">for</span> <span class="n">the</span> <span class="n">nodes</span>
<a id="ln-715" name="ln-715"></a>    <span class="err">!!</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span> <span class="n">The</span> <span class="n">numbering</span> <span class="n">of</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">starts</span> <span class="n">from</span> <span class="n">either</span> <span class="mi">0</span> <span class="n">or</span> <span class="mi">1</span><span class="p">,</span> <span class="n">depending</span> <span class="k">on</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span>
<a id="ln-716" name="ln-716"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">options</span><span class="p">(</span><span class="n">METIS_OPTION_NUMBERING</span><span class="p">)</span><span class="err">`.</span>
<a id="ln-717" name="ln-717"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-718" name="ln-718"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span>
<a id="ln-719" name="ln-719"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_INPUT</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">an</span> <span class="n">input</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-720" name="ln-720"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_MEMORY</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">it</span> <span class="n">could</span> <span class="n">not</span> <span class="n">allocate</span> <span class="n">the</span> <span class="n">required</span> <span class="n">memory</span><span class="err">.</span>
<a id="ln-721" name="ln-721"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">some</span> <span class="n">other</span> <span class="k">type</span> <span class="n">of</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-722" name="ln-722"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_PartMeshNodal</span>
<a id="ln-723" name="ln-723"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-724" name="ln-724"></a>
<a id="ln-725" name="ln-725"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_PartMeshNodal</span>
<a id="ln-726" name="ln-726"></a>
<a id="ln-727" name="ln-727"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-728" name="ln-728"></a><span class="err">!</span>
<a id="ln-729" name="ln-729"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-730" name="ln-730"></a>
<a id="ln-731" name="ln-731"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-732" name="ln-732"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">27</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-733" name="ln-733"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> 	<span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-734" name="ln-734"></a><span class="err">!</span>
<a id="ln-735" name="ln-735"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-736" name="ln-736"></a><span class="err">!</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-737" name="ln-737"></a><span class="err">!</span>
<a id="ln-738" name="ln-738"></a><span class="err">!@</span><span class="n">note</span>
<a id="ln-739" name="ln-739"></a><span class="err">!</span> <span class="n">To</span> <span class="n">use</span> <span class="n">the</span> <span class="n">returned</span> <span class="n">arrays</span> <span class="err">`</span><span class="n">xadj</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">adjncy</span><span class="err">`</span><span class="p">,</span> <span class="n">these</span> <span class="n">must</span> <span class="n">be</span> <span class="n">first</span> <span class="n">converted</span> <span class="n">from</span>
<a id="ln-740" name="ln-740"></a><span class="err">!</span> <span class="n">a</span> <span class="n">C</span> <span class="n">pointer</span> <span class="n">to</span> <span class="n">a</span> <span class="n">Fortran</span> <span class="n">pointer</span> <span class="n">using</span> <span class="n">the</span> <span class="n">subroutine</span> <span class="err">`</span><span class="n">c_f_pointer</span><span class="p">(</span><span class="n">cptr</span><span class="p">,</span><span class="n">fptr</span><span class="p">,</span><span class="n">shape</span><span class="p">)</span><span class="err">`</span>
<a id="ln-741" name="ln-741"></a><span class="err">!</span> <span class="n">that</span> <span class="n">assigns</span> <span class="n">the</span> <span class="n">target</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">pointer</span> <span class="err">`</span><span class="n">cptr</span><span class="err">`</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Fortran</span> <span class="n">pointer</span> <span class="err">`</span><span class="n">fptr</span><span class="err">`</span> <span class="n">and</span>
<a id="ln-742" name="ln-742"></a><span class="err">!</span> <span class="n">specifies</span> <span class="n">its</span> <span class="n">shape</span><span class="err">.</span> <span class="n">The</span> <span class="err">`</span><span class="n">shape</span><span class="err">`</span> <span class="n">is</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">rank</span><span class="o">-</span><span class="n">one</span> <span class="n">array</span><span class="p">,</span> <span class="n">storing</span> <span class="n">the</span> <span class="n">size</span> <span class="err">`</span><span class="n">ne</span><span class="o">+</span><span class="mi">1</span><span class="err">`</span>
<a id="ln-743" name="ln-743"></a><span class="err">!</span> <span class="n">in</span> <span class="k">case</span> <span class="n">of</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">.</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">new</span> <span class="err">`</span><span class="n">adjncy</span><span class="err">`</span> <span class="n">array</span> <span class="n">is</span> <span class="n">stored</span> <span class="n">in</span> <span class="n">the</span>
<a id="ln-744" name="ln-744"></a><span class="err">!</span> <span class="n">last</span> <span class="n">element</span> <span class="n">of</span> <span class="err">`</span><span class="n">xadj</span><span class="err">`</span> <span class="n">when</span> <span class="n">using</span> <span class="n">C</span><span class="o">-</span><span class="n">style</span> <span class="n">numbering</span><span class="err">.</span> <span class="n">An</span> <span class="n">example</span> <span class="n">is</span> <span class="n">shown</span> <span class="n">below</span><span class="err">.</span>
<a id="ln-745" name="ln-745"></a><span class="err">!@</span><span class="n">endnote</span>
<a id="ln-746" name="ln-746"></a><span class="err">!</span>
<a id="ln-747" name="ln-747"></a><span class="err">!@</span><span class="k">warning</span>
<a id="ln-748" name="ln-748"></a><span class="err">!</span> <span class="n">Memory</span> <span class="n">for</span> <span class="n">the</span> <span class="n">returned</span> <span class="n">arrays</span> <span class="err">`</span><span class="n">xadj</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">adjncy</span><span class="err">`</span> <span class="n">is</span> <span class="n">allocated</span> <span class="n">by</span> <span class="n">METIS</span><span class="err">&#39;</span> <span class="n">API</span> <span class="n">in</span> <span class="n">C</span>
<a id="ln-749" name="ln-749"></a><span class="err">!</span> <span class="n">using</span> <span class="n">the</span> <span class="n">standard</span> <span class="err">`</span><span class="n">malloc</span><span class="err">`</span> <span class="n">function</span><span class="err">.</span> <span class="n">It</span> <span class="n">is</span> <span class="n">the</span> <span class="n">responsibility</span> <span class="n">of</span> <span class="n">the</span> <span class="n">application</span> <span class="n">to</span> <span class="n">free</span>
<a id="ln-750" name="ln-750"></a><span class="err">!</span> <span class="n">this</span> <span class="n">memory</span> <span class="n">by</span> <span class="n">calling</span> <span class="err">`</span><span class="n">free</span><span class="err">`.</span> <span class="n">Therefore</span><span class="p">,</span> <span class="n">METIS</span> <span class="n">provides</span> <span class="n">the</span> <span class="p">[[</span><span class="n">METIS_Free</span><span class="p">]]</span> <span class="n">function</span> <span class="n">that</span> <span class="n">is</span> <span class="n">a</span> <span class="n">wrapper</span> <span class="n">to</span>
<a id="ln-751" name="ln-751"></a><span class="err">!</span> <span class="n">C</span><span class="err">&#39;</span><span class="n">s</span> <span class="err">`</span><span class="n">free</span><span class="err">`</span><span class="n">function</span><span class="err">.</span>
<a id="ln-752" name="ln-752"></a><span class="err">!@</span><span class="n">endwarning</span>
<a id="ln-753" name="ln-753"></a><span class="err">!</span>
<a id="ln-754" name="ln-754"></a><span class="err">!</span> <span class="k">int</span> <span class="n">METIS</span> <span class="n">MeshToDual</span><span class="p">(</span><span class="n">idx</span> <span class="k">t</span> <span class="o">*</span><span class="n">ne</span><span class="p">,</span> <span class="n">idx</span> <span class="k">t</span> <span class="o">*</span><span class="n">nn</span><span class="p">,</span> <span class="n">idx</span> <span class="k">t</span> <span class="o">*</span><span class="n">eptr</span><span class="p">,</span> <span class="n">idx</span> <span class="k">t</span> <span class="o">*</span><span class="n">eind</span><span class="p">,</span> <span class="n">idx</span> <span class="k">t</span> <span class="o">*</span><span class="n">ncommon</span><span class="p">,</span> <span class="n">idx</span> <span class="k">t</span> <span class="o">*</span><span class="n">numflag</span><span class="p">,</span> <span class="n">idx</span> <span class="k">t</span> <span class="o">**</span><span class="n">xadj</span><span class="p">,</span> <span class="n">idx</span> <span class="k">t</span> <span class="o">**</span><span class="n">adjncy</span><span class="p">)</span>
<a id="ln-755" name="ln-755"></a><span class="err">!</span>
<a id="ln-756" name="ln-756"></a>
<a id="ln-757" name="ln-757"></a>
<a id="ln-758" name="ln-758"></a><span class="n">INTERFACE</span>
<a id="ln-759" name="ln-759"></a><span class="n">FUNCTION</span> <span class="n">METIS_MeshToDual</span><span class="p">(</span> <span class="n">ne</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="n">eptr</span><span class="p">,</span> <span class="n">eind</span><span class="p">,</span> <span class="n">ncommon</span><span class="p">,</span> <span class="n">numflag</span><span class="p">,</span> <span class="n">xadj</span><span class="p">,</span> <span class="err">&amp;</span>
<a id="ln-760" name="ln-760"></a>  <span class="err">&amp;</span> <span class="n">adjncy</span><span class="p">)</span> <span class="n">RESULT</span><span class="p">(</span><span class="n">Ans</span><span class="p">)</span> <span class="n">BIND</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;METIS_MeshToDual&quot;</span><span class="p">)</span>
<a id="ln-761" name="ln-761"></a>  <span class="n">IMPORT</span>
<a id="ln-762" name="ln-762"></a>
<a id="ln-763" name="ln-763"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">ne</span>
<a id="ln-764" name="ln-764"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">elements</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-765" name="ln-765"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nn</span>
<a id="ln-766" name="ln-766"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-767" name="ln-767"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">eptr</span><span class="p">(</span> <span class="o">*</span> <span class="p">),</span> <span class="n">eind</span><span class="p">(</span> <span class="o">*</span> <span class="p">)</span>
<a id="ln-768" name="ln-768"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">arrays</span> <span class="n">storing</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span>
<a id="ln-769" name="ln-769"></a>    <span class="err">!!</span> <span class="n">Section</span> <span class="mf">5.6</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-770" name="ln-770"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">ncommon</span>
<a id="ln-771" name="ln-771"></a>    <span class="err">!!</span> <span class="n">Specifies</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">common</span> <span class="n">nodes</span> <span class="n">that</span> <span class="n">two</span> <span class="n">elements</span> <span class="n">must</span> <span class="n">have</span> <span class="n">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">put</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">between</span> <span class="n">them</span> <span class="n">in</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">.</span> <span class="n">Given</span> <span class="n">two</span> <span class="n">elements</span> <span class="n">e1</span> <span class="n">and</span> <span class="n">e2</span><span class="p">,</span> <span class="n">containing</span> <span class="n">n1</span> <span class="n">and</span> <span class="n">n2</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">respectively</span><span class="p">,</span> <span class="n">then</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">will</span> <span class="n">connect</span> <span class="n">the</span> <span class="n">vertices</span> <span class="n">in</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">graph</span> <span class="n">corresponding</span> <span class="n">to</span> <span class="n">e1</span> <span class="n">and</span> <span class="n">e2</span> <span class="k">if</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">common</span> <span class="n">nodes</span> <span class="n">between</span> <span class="n">them</span> <span class="n">is</span> <span class="n">greater</span> <span class="n">than</span> <span class="n">or</span> <span class="n">equal</span> <span class="n">to</span> <span class="k">min</span><span class="p">(</span><span class="n">ncommon</span><span class="p">;</span> <span class="n">n1</span> <span class="err">−</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n2</span> <span class="err">−</span> <span class="mi">1</span><span class="p">)</span><span class="err">.</span> <span class="n">The</span> <span class="k">default</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">1</span><span class="p">,</span> <span class="n">indicating</span> <span class="n">that</span> <span class="n">two</span> <span class="n">elements</span> <span class="n">will</span> <span class="n">be</span> <span class="n">connected</span> <span class="n">via</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">as</span> <span class="n">long</span> <span class="n">as</span> <span class="n">they</span> <span class="n">share</span> <span class="n">one</span> <span class="n">node</span><span class="err">.</span> <span class="n">However</span><span class="p">,</span> <span class="n">this</span> <span class="n">will</span> <span class="n">tend</span> <span class="n">to</span> <span class="n">create</span> <span class="n">too</span> <span class="n">many</span> <span class="n">edges</span> <span class="p">(</span><span class="n">increasing</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">and</span> <span class="n">time</span> <span class="n">requirements</span> <span class="n">of</span> <span class="n">the</span> <span class="n">partitioning</span><span class="p">)</span><span class="err">.</span> <span class="n">The</span> <span class="n">user</span> <span class="n">should</span> <span class="n">select</span> <span class="n">higher</span> <span class="n">values</span> <span class="n">that</span> <span class="n">are</span> <span class="n">better</span> <span class="n">suited</span> <span class="n">for</span> <span class="n">the</span> <span class="n">element</span> <span class="n">types</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">that</span> <span class="n">wants</span> <span class="n">to</span> <span class="n">partition</span><span class="err">.</span> <span class="n">For</span> <span class="n">example</span><span class="p">,</span> <span class="n">for</span> <span class="n">tetrahedron</span> <span class="n">meshes</span><span class="p">,</span> <span class="n">ncommon</span> <span class="n">should</span> <span class="n">be</span> <span class="mi">3</span><span class="p">,</span> <span class="n">which</span> <span class="n">creates</span> <span class="n">an</span> <span class="n">edge</span> <span class="n">between</span> <span class="n">two</span> <span class="n">tets</span> <span class="n">when</span> <span class="n">they</span> <span class="n">share</span> <span class="n">a</span> <span class="n">triangular</span> <span class="n">face</span> <span class="p">(</span><span class="n">i</span><span class="err">.</span><span class="n">e</span><span class="err">.</span><span class="p">,</span> <span class="mi">3</span> <span class="n">nodes</span><span class="p">)</span>
<a id="ln-772" name="ln-772"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">numflag</span>
<a id="ln-773" name="ln-773"></a>    <span class="err">!!</span> <span class="n">Used</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">which</span> <span class="n">numbering</span> <span class="n">scheme</span> <span class="n">is</span> <span class="n">used</span> <span class="n">for</span> <span class="err">`</span><span class="n">eptr</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">eind</span><span class="err">`.</span>
<a id="ln-774" name="ln-774"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">possible</span> <span class="n">values</span> <span class="n">are</span><span class="err">:</span> <span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-775" name="ln-775"></a>    <span class="err">!!</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">C</span><span class="o">-</span><span class="n">style</span> <span class="n">numbering</span> <span class="n">is</span> <span class="n">assumed</span> <span class="n">that</span> <span class="n">starts</span> <span class="n">from</span> <span class="mi">0</span> <span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-776" name="ln-776"></a>    <span class="err">!!</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Fortran</span><span class="o">-</span><span class="n">style</span> <span class="n">numbering</span> <span class="n">is</span> <span class="n">assumed</span> <span class="n">that</span> <span class="n">starts</span> <span class="n">from</span> <span class="mi">1</span>
<a id="ln-777" name="ln-777"></a>  <span class="n">TYPE</span><span class="p">(</span><span class="n">C_PTR</span><span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">xadj</span><span class="p">,</span> <span class="n">adjncy</span>
<a id="ln-778" name="ln-778"></a>    <span class="err">!!</span> <span class="n">These</span> <span class="n">arrays</span> <span class="n">store</span> <span class="n">the</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">the</span> <span class="n">generated</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">.</span> <span class="n">The</span> <span class="n">format</span> <span class="n">of</span> <span class="n">the</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">is</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf). Memory for these arrays is allocated by METIS’ API using the standard malloc function. It is the responsibility of the application to free this memory by calling free. METIS provides the METIS Free that is a wrapper to C’s free function.</span>
<a id="ln-779" name="ln-779"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">Ans</span>
<a id="ln-780" name="ln-780"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-781" name="ln-781"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_INPUT</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">an</span> <span class="n">input</span> <span class="k">error</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-782" name="ln-782"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_MEMORY</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">it</span> <span class="n">could</span> <span class="n">not</span> <span class="n">allocate</span> <span class="n">the</span> <span class="n">required</span> <span class="n">memory</span><span class="err">.</span><span class="p">&lt;</span><span class="n">br</span> <span class="o">/</span><span class="p">&gt;</span>
<a id="ln-783" name="ln-783"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">some</span> <span class="n">other</span> <span class="k">type</span> <span class="n">of</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-784" name="ln-784"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_MeshToDual</span>
<a id="ln-785" name="ln-785"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-786" name="ln-786"></a>
<a id="ln-787" name="ln-787"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_MeshToDual</span>
<a id="ln-788" name="ln-788"></a>
<a id="ln-789" name="ln-789"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-790" name="ln-790"></a><span class="err">!</span>
<a id="ln-791" name="ln-791"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-792" name="ln-792"></a>
<a id="ln-793" name="ln-793"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">authors</span><span class="err">:</span> <span class="n">Vikas</span> <span class="n">Sharma</span><span class="p">,</span> <span class="n">Ph</span><span class="err">.</span> <span class="n">D</span><span class="err">.</span>
<a id="ln-794" name="ln-794"></a><span class="err">!</span> <span class="n">date</span><span class="err">:</span> <span class="mi">27</span> <span class="n">July</span> <span class="mi">2021</span>
<a id="ln-795" name="ln-795"></a><span class="err">!</span> <span class="n">summary</span><span class="err">:</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">nodal</span> <span class="n">graph</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-796" name="ln-796"></a><span class="err">!</span>
<a id="ln-797" name="ln-797"></a><span class="err">!###</span> <span class="n">Introduction</span>
<a id="ln-798" name="ln-798"></a><span class="err">!</span> <span class="n">This</span> <span class="n">function</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">nodal</span> <span class="n">graph</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-799" name="ln-799"></a><span class="err">!</span>
<a id="ln-800" name="ln-800"></a><span class="err">!@</span><span class="n">note</span>
<a id="ln-801" name="ln-801"></a><span class="err">!</span> <span class="n">To</span> <span class="n">use</span> <span class="n">the</span> <span class="n">returned</span> <span class="n">arrays</span> <span class="err">`</span><span class="n">xadj</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">adjncy</span><span class="err">`</span><span class="p">,</span> <span class="n">these</span> <span class="n">must</span> <span class="n">be</span> <span class="n">first</span> <span class="n">converted</span> <span class="n">from</span>
<a id="ln-802" name="ln-802"></a><span class="err">!</span> <span class="n">a</span> <span class="n">C</span> <span class="n">pointer</span> <span class="n">to</span> <span class="n">a</span> <span class="n">Fortran</span> <span class="n">pointer</span> <span class="n">using</span> <span class="n">the</span> <span class="n">subroutine</span> <span class="err">`</span><span class="n">c_f_pointer</span><span class="p">(</span><span class="n">cptr</span><span class="p">,</span><span class="n">fptr</span><span class="p">,</span><span class="n">shape</span><span class="p">)</span><span class="err">`</span>
<a id="ln-803" name="ln-803"></a><span class="err">!</span> <span class="n">that</span> <span class="n">assigns</span> <span class="n">the</span> <span class="n">target</span> <span class="n">of</span> <span class="n">the</span> <span class="n">C</span> <span class="n">pointer</span> <span class="err">`</span><span class="n">cptr</span><span class="err">`</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Fortran</span> <span class="n">pointer</span> <span class="err">`</span><span class="n">fptr</span><span class="err">`</span> <span class="n">and</span>
<a id="ln-804" name="ln-804"></a><span class="err">!</span> <span class="n">specifies</span> <span class="n">its</span> <span class="n">shape</span><span class="err">.</span> <span class="n">The</span> <span class="err">`</span><span class="n">shape</span><span class="err">`</span> <span class="n">is</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">rank</span><span class="o">-</span><span class="n">one</span> <span class="n">array</span><span class="p">,</span> <span class="n">storing</span> <span class="n">the</span> <span class="n">size</span> <span class="err">`</span><span class="n">nn</span><span class="o">+</span><span class="mi">1</span><span class="err">`</span>
<a id="ln-805" name="ln-805"></a><span class="err">!</span> <span class="n">in</span> <span class="k">case</span> <span class="n">of</span> <span class="n">the</span> <span class="n">nodal</span> <span class="n">graph</span><span class="err">.</span> <span class="n">The</span> <span class="n">size</span> <span class="n">of</span> <span class="n">the</span> <span class="n">new</span> <span class="err">`</span><span class="n">adjncy</span><span class="err">`</span> <span class="n">array</span> <span class="n">is</span> <span class="n">stored</span> <span class="n">in</span> <span class="n">the</span>
<a id="ln-806" name="ln-806"></a><span class="err">!</span> <span class="n">last</span> <span class="n">element</span> <span class="n">of</span> <span class="err">`</span><span class="n">xadj</span><span class="err">`</span> <span class="n">when</span> <span class="n">using</span> <span class="n">C</span><span class="o">-</span><span class="n">style</span> <span class="n">numbering</span><span class="err">.</span> <span class="n">An</span> <span class="n">example</span> <span class="n">is</span> <span class="n">shown</span> <span class="n">below</span><span class="err">.</span>
<a id="ln-807" name="ln-807"></a><span class="err">!@</span><span class="n">endnote</span>
<a id="ln-808" name="ln-808"></a><span class="err">!</span>
<a id="ln-809" name="ln-809"></a><span class="err">!@</span><span class="k">warning</span>
<a id="ln-810" name="ln-810"></a><span class="err">!</span> <span class="n">Memory</span> <span class="n">for</span> <span class="n">the</span> <span class="n">returned</span> <span class="n">arrays</span> <span class="err">`</span><span class="n">xadj</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">adjncy</span><span class="err">`</span> <span class="n">is</span> <span class="n">allocated</span> <span class="n">by</span> <span class="n">METIS</span><span class="err">&#39;</span> <span class="n">API</span> <span class="n">in</span> <span class="n">C</span>
<a id="ln-811" name="ln-811"></a><span class="err">!</span> <span class="n">using</span> <span class="n">the</span> <span class="n">standard</span> <span class="err">`</span><span class="n">malloc</span><span class="err">`</span> <span class="n">function</span><span class="err">.</span> <span class="n">It</span> <span class="n">is</span> <span class="n">the</span> <span class="n">responsibility</span> <span class="n">of</span> <span class="n">the</span> <span class="n">application</span> <span class="n">to</span> <span class="n">free</span>
<a id="ln-812" name="ln-812"></a><span class="err">!</span> <span class="n">this</span> <span class="n">memory</span> <span class="n">by</span> <span class="n">calling</span> <span class="err">`</span><span class="n">free</span><span class="err">`.</span> <span class="n">Therefore</span><span class="p">,</span> <span class="n">METIS</span> <span class="n">provides</span> <span class="n">the</span> <span class="p">[[</span><span class="n">METIS_Free</span><span class="p">]]</span> <span class="n">function</span> <span class="n">that</span> <span class="n">is</span> <span class="n">a</span> <span class="n">wrapper</span> <span class="n">to</span>
<a id="ln-813" name="ln-813"></a><span class="err">!</span> <span class="n">C</span><span class="err">&#39;</span><span class="n">s</span> <span class="err">`</span><span class="n">free</span><span class="err">`</span><span class="n">function</span><span class="err">.</span>
<a id="ln-814" name="ln-814"></a><span class="err">!@</span><span class="n">endwarning</span>
<a id="ln-815" name="ln-815"></a>
<a id="ln-816" name="ln-816"></a><span class="n">INTERFACE</span>
<a id="ln-817" name="ln-817"></a><span class="n">FUNCTION</span> <span class="n">METIS_MeshToNodal</span><span class="p">(</span><span class="n">ne</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">eptr</span><span class="p">,</span><span class="n">eind</span><span class="p">,</span><span class="n">numflag</span><span class="p">,</span><span class="n">xadj</span><span class="p">,</span><span class="n">adjncy</span><span class="p">)</span> <span class="err">&amp;</span>
<a id="ln-818" name="ln-818"></a>  <span class="err">&amp;</span> <span class="n">RESULT</span><span class="p">(</span><span class="n">Ans</span><span class="p">)</span> <span class="n">BIND</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;METIS_MeshToNodal&quot;</span><span class="p">)</span>
<a id="ln-819" name="ln-819"></a>  <span class="n">IMPORT</span>
<a id="ln-820" name="ln-820"></a>
<a id="ln-821" name="ln-821"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">ne</span>
<a id="ln-822" name="ln-822"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">elements</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-823" name="ln-823"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">nn</span>
<a id="ln-824" name="ln-824"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">in</span> <span class="n">the</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-825" name="ln-825"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">eptr</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">eind</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a id="ln-826" name="ln-826"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">arrays</span> <span class="n">storing</span> <span class="n">the</span> <span class="nb">mesh</span> <span class="n">as</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.6</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf).</span>
<a id="ln-827" name="ln-827"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="err">::</span> <span class="n">numflag</span>
<a id="ln-828" name="ln-828"></a>    <span class="err">!!</span> <span class="n">Used</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">which</span> <span class="n">numbering</span> <span class="n">scheme</span> <span class="n">is</span> <span class="n">used</span> <span class="n">for</span> <span class="err">`</span><span class="n">eptr</span><span class="err">`</span> <span class="n">and</span> <span class="err">`</span><span class="n">eind</span><span class="err">`.</span>
<a id="ln-829" name="ln-829"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">possible</span> <span class="n">values</span> <span class="n">are</span><span class="err">:</span>
<a id="ln-830" name="ln-830"></a>    <span class="err">!!</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">C</span><span class="o">-</span><span class="n">style</span> <span class="n">numbering</span> <span class="n">is</span> <span class="n">assumed</span> <span class="n">that</span> <span class="n">starts</span> <span class="n">from</span> <span class="mi">0</span>
<a id="ln-831" name="ln-831"></a>    <span class="err">!!</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">Fortran</span><span class="o">-</span><span class="n">style</span> <span class="n">numbering</span> <span class="n">is</span> <span class="n">assumed</span> <span class="n">that</span> <span class="n">starts</span> <span class="n">from</span> <span class="mi">1</span>
<a id="ln-832" name="ln-832"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="err">::</span> <span class="n">xadj</span><span class="p">,</span> <span class="n">adjncy</span>
<a id="ln-833" name="ln-833"></a>    <span class="err">!!</span> <span class="n">These</span> <span class="n">arrays</span> <span class="n">store</span> <span class="n">the</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">the</span> <span class="n">generated</span> <span class="n">dual</span> <span class="n">graph</span><span class="err">.</span> <span class="n">The</span> <span class="n">format</span> <span class="n">of</span> <span class="n">the</span> <span class="n">adjacency</span> <span class="n">structure</span> <span class="n">is</span> <span class="n">described</span> <span class="n">in</span> <span class="n">Section</span> <span class="mf">5.5</span> <span class="n">of</span> <span class="n">the</span> <span class="p">[</span><span class="n">manual</span><span class="p">](</span><span class="n">http</span><span class="err">:</span><span class="c1">//glaros.dtc.umn.edu/gkhome/fetch/sw/metis/manual.pdf). Memory for these arrays is allocated by METIS’ API using the standard malloc function. It is the responsibility of the application to free this memory by calling free. METIS provides the METIS Free that is a wrapper to C’s free function.</span>
<a id="ln-834" name="ln-834"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-835" name="ln-835"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span>
<a id="ln-836" name="ln-836"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_INPUT</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">an</span> <span class="n">input</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-837" name="ln-837"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR_MEMORY</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">it</span> <span class="n">could</span> <span class="n">not</span> <span class="n">allocate</span> <span class="n">the</span> <span class="n">required</span> <span class="n">memory</span><span class="err">.</span>
<a id="ln-838" name="ln-838"></a>    <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_ERROR</span><span class="err">`</span> <span class="o">-</span> <span class="n">Indicates</span> <span class="n">some</span> <span class="n">other</span> <span class="k">type</span> <span class="n">of</span> <span class="k">error</span><span class="err">.</span>
<a id="ln-839" name="ln-839"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_MeshToNodal</span>
<a id="ln-840" name="ln-840"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-841" name="ln-841"></a>
<a id="ln-842" name="ln-842"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_MeshToNodal</span>
<a id="ln-843" name="ln-843"></a>
<a id="ln-844" name="ln-844"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-845" name="ln-845"></a><span class="err">!</span>                                                               <span class="n">METIS_Free</span>
<a id="ln-846" name="ln-846"></a><span class="err">!</span><span class="o">----------------------------------------------------------------------------</span>
<a id="ln-847" name="ln-847"></a>
<a id="ln-848" name="ln-848"></a><span class="err">!</span><span class="p">&gt;</span> <span class="n">Frees</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">that</span> <span class="n">was</span> <span class="n">allocated</span> <span class="n">by</span> <span class="n">either</span> <span class="n">the</span> <span class="p">[[</span><span class="n">METIS_MeshToDual</span><span class="p">]]</span> <span class="n">or</span> <span class="n">the</span>
<a id="ln-849" name="ln-849"></a><span class="err">!</span>  <span class="p">[[</span><span class="n">METIS_MeshToNodal</span><span class="p">]]</span> <span class="n">routines</span> <span class="n">for</span> <span class="n">returning</span> <span class="n">the</span> <span class="n">dual</span> <span class="n">or</span> <span class="n">nodal</span> <span class="n">graph</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">mesh</span><span class="err">.</span>
<a id="ln-850" name="ln-850"></a><span class="err">!</span>
<a id="ln-851" name="ln-851"></a><span class="err">!@</span><span class="k">warning</span> <span class="n">Memory</span> <span class="n">deallocation</span> <span class="n">should</span> <span class="n">always</span> <span class="n">happen</span> <span class="k">on</span> <span class="n">the</span> <span class="n">same</span> <span class="n">side</span> <span class="n">it</span> <span class="n">was</span> <span class="n">allocated</span><span class="err">!</span>
<a id="ln-852" name="ln-852"></a><span class="err">!</span> <span class="n">Also</span> <span class="n">check</span> <span class="n">the</span> <span class="n">descriptions</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span><span class="o">-</span><span class="n">mentioned</span> <span class="n">routines</span><span class="err">.</span>
<a id="ln-853" name="ln-853"></a><span class="err">!</span>
<a id="ln-854" name="ln-854"></a><span class="err">!#</span> <span class="n">Example</span>
<a id="ln-855" name="ln-855"></a><span class="err">!</span>
<a id="ln-856" name="ln-856"></a><span class="err">!```</span><span class="n">Fortran</span>
<a id="ln-857" name="ln-857"></a><span class="err">!</span> <span class="k">type</span><span class="p">(</span><span class="n">c_ptr</span><span class="p">)</span> <span class="err">::</span> <span class="n">xadj</span><span class="p">(</span><span class="err">:</span><span class="p">),</span><span class="n">adjncy</span><span class="p">(</span><span class="err">:</span><span class="p">)</span>
<a id="ln-858" name="ln-858"></a><span class="err">!</span>
<a id="ln-859" name="ln-859"></a><span class="err">!</span> <span class="n">call</span> <span class="n">METIS_MeshToNodal</span><span class="p">(</span><span class="err">...</span><span class="p">,</span><span class="n">xadj</span><span class="p">,</span><span class="n">adjncy</span><span class="p">)</span>
<a id="ln-860" name="ln-860"></a><span class="err">!</span>
<a id="ln-861" name="ln-861"></a><span class="err">!</span> <span class="err">!</span> <span class="n">xadj</span> <span class="n">and</span> <span class="n">adjncy</span> <span class="n">should</span> <span class="n">be</span> <span class="n">deallocated</span> <span class="k">on</span> <span class="n">the</span> <span class="n">C</span> <span class="n">side</span><span class="err">!</span> <span class="p">;)</span>
<a id="ln-862" name="ln-862"></a><span class="err">!</span> <span class="n">call</span> <span class="n">METIS_Free</span><span class="p">(</span><span class="n">xadj</span><span class="p">)</span>
<a id="ln-863" name="ln-863"></a><span class="err">!</span> <span class="n">call</span> <span class="n">METIS_Free</span><span class="p">(</span><span class="n">adjncy</span><span class="p">)</span>
<a id="ln-864" name="ln-864"></a><span class="err">!```</span>
<a id="ln-865" name="ln-865"></a>
<a id="ln-866" name="ln-866"></a><span class="n">INTERFACE</span>
<a id="ln-867" name="ln-867"></a><span class="n">FUNCTION</span> <span class="n">METIS_Free</span><span class="p">(</span><span class="n">ptr</span><span class="p">)</span> <span class="n">RESULT</span><span class="p">(</span> <span class="n">ans</span> <span class="p">)</span> <span class="n">BIND</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;METIS_Free&quot;</span><span class="p">)</span>
<a id="ln-868" name="ln-868"></a>  <span class="n">IMPORT</span>
<a id="ln-869" name="ln-869"></a>  <span class="n">TYPE</span><span class="p">(</span> <span class="n">C_PTR</span> <span class="p">),</span> <span class="n">VALUE</span> <span class="err">::</span> <span class="n">ptr</span>
<a id="ln-870" name="ln-870"></a>    <span class="err">!!</span> <span class="n">The</span> <span class="n">pointer</span> <span class="n">to</span> <span class="n">be</span> <span class="n">freed</span><span class="err">.</span> <span class="n">This</span> <span class="n">pointer</span> <span class="n">should</span> <span class="n">be</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="err">`</span><span class="n">xadj</span><span class="err">`</span> <span class="n">or</span> <span class="err">`</span><span class="n">adjncy</span><span class="err">`</span><span class="p">,</span> <span class="n">arrays</span> <span class="n">returned</span> <span class="n">by</span> <span class="n">METIS</span><span class="err">&#39;</span> <span class="n">API</span> <span class="n">routines</span>
<a id="ln-871" name="ln-871"></a>  <span class="n">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="err">::</span> <span class="n">ans</span>
<a id="ln-872" name="ln-872"></a>  <span class="err">!!</span> <span class="err">`</span><span class="n">METIS_OK</span><span class="err">`</span> <span class="n">Indicates</span> <span class="n">that</span> <span class="n">the</span> <span class="n">function</span> <span class="n">returned</span> <span class="n">normally</span><span class="err">.</span>
<a id="ln-873" name="ln-873"></a><span class="n">END</span> <span class="n">FUNCTION</span> <span class="n">METIS_Free</span>
<a id="ln-874" name="ln-874"></a><span class="n">END</span> <span class="n">INTERFACE</span>
<a id="ln-875" name="ln-875"></a>
<a id="ln-876" name="ln-876"></a><span class="n">PUBLIC</span> <span class="err">::</span> <span class="n">METIS_FREE</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>EASIFEM-BASE was developed by Vikas Sharma<br>&copy; 2021 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
             on 2021-10-02 00:01  
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>