<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A frame work for Expandable And Scalable Infrastructure for Finite Element Methods">
    
    <meta name="author" content="Vikas Sharma" >
    <link rel="icon" href="../favicon.png">

    <title>MetisNodeND &ndash; EASIFEM-BASE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EASIFEM-BASE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>easifemBase</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>




          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>MetisNodeND
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
    <li><i class="fa fa-calendar-o"></i> 28 Jul 2021</li>
     
     
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a></li> 
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">35 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/MetisInterface.F90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/metisinterface.f90.html'>MetisInterface.F90</a></li>
    
     <li><a href='../module/metisinterface.html'>MetisInterface</a></li>
    
  
     <li class="active">MetisNodeND</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<em>None</em>


</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine MetisNodeND(XADJ, ADJNCY, PERM, IPERM, OPTIONS, VWGT)
    
    
   
</h2>
    
  


    
    <h3 id="introduction">Introduction</h3>
<p>This function computes fill reducing orderings of sparse matrices using the multilevel nested dissection algorithm.</p>
<ul>
<li>Let $A$ be the original matrix and $A*$ be the permuted matrix.</li>
<li>The arrays <code>perm</code> and <code>iperm</code> are defined as follows.</li>
<li>Row (column) <code>i</code> of $A*$ is the <code>perm(i)</code> row (column) of $A$</li>
<li>Row (column) <code>i</code> of $A$ is the <code>iperm(i)</code> row (column) of $A*$.</li>
<li>The numbering of this vector starts from either 0 or 1, depending on the value of <code>options(METIS_OPTION_NUMBERING)</code>.</li>
</ul>
<p>If the graph is weighted, meaning <code>vgwt</code> was provided, the nested dissection ordering computes vertex separators that minimize the sum of the weights of the vertices on the separators.</p>
<p>GRAPH DATA STRUCTURE</p>
<p>The adjacency structure of the graph is stored using the compressed storage format (CSR). The CSR format is a widely used scheme for storing sparse graphs. In this format the adjacency structure of a graph with n vertices and m edges is represented using two arrays xadj and adjncy. The xadj array is of size n + 1 whereas the adjncy array is of size 2m (this is because for each edge between vertices v and u we actually store both (v; u) and (u; v))</p>
<p>The adjacency structure of the graph is stored as follows. Assuming that vertex numbering starts from 0 (C style), then the adjacency list of vertex i is stored in array adjncy starting at index xadj[i] and ending at (but not including) index xadj[i + 1] (i.e., adjncy[xadj[i]] through and including adjncy[xadj[i + 1]-1]). That is, for each vertex i, its adjacency list is stored in consecutive locations in the array adjncy, and the array xadj is used to point to where it begins and where it ends. Figure 3(b) illustrates the CSR format for the 15-vertex graph shown in Figure 3(a)</p>
<p>The weights of the vertices (if any) are stored in an additional array called vwgt. If ncon is the number of weights associated with each vertex, the array vwgt contains n ∗ ncon elements (recall that n is the number of vertices). The weights of the ith vertex are stored in ncon consecutive entries starting at location vwgt[i ∗ ncon]. Note that if each vertex has only a single weight, then vwgt will contain n elements, and vwgt[i] will store the weight of the ith vertex. The vertex-weights must be integers greater or equal to zero. If all the vertices of the graph have the same weight (i.e., the graph is unweighted), then the vwgt can be set to NULL.</p>
<h3 id="usage">Usage</h3>
<div class="codehilite"><pre><span></span><code> <span class="kt">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>
   <span class="c">!! number of vertices</span>
 <span class="kt">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">22</span>
   <span class="c">!! number of edges</span>
 <span class="kt">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">XADJ</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">ADJNCY</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
   <span class="c">!! graph adjacency structure</span>
   <span class="c">!! XADJ, ADJNCY</span>
 <span class="kt">INTEGER</span><span class="p">(</span> <span class="n">I4B</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">PERM</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">IPERM</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="c">!! fill-reducing permutation andinverse permutatio</span>
 <span class="k">CALL </span><span class="n">Display</span><span class="p">(</span> <span class="s2">&quot;TESTING METISNodeND&quot;</span> <span class="p">)</span>
 <span class="n">XADJ</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">45</span><span class="p">]</span>
 <span class="n">ADJNCY</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="p">&amp;</span> <span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span> <span class="p">&amp;</span>
   <span class="p">&amp;</span> <span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">]</span>
 <span class="k">CALL </span><span class="n">METISNodeND</span><span class="p">(</span><span class="n">XADJ</span><span class="o">=</span><span class="n">XADJ</span><span class="p">,</span> <span class="n">ADJNCY</span><span class="o">=</span><span class="n">ADJNCY</span><span class="p">,</span> <span class="n">PERM</span><span class="o">=</span><span class="n">PERM</span><span class="p">,</span> <span class="n">IPERM</span><span class="o">=</span><span class="n">IPERM</span> <span class="p">)</span>
 <span class="k">CALL </span><span class="n">DISP</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="n">PERM</span><span class="p">,</span>  <span class="n">title</span><span class="o">=</span> <span class="s2">&quot; PERM = &quot;</span> <span class="p">)</span>
 <span class="k">CALL </span><span class="n">DISP</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="n">IPERM</span><span class="p">,</span>  <span class="n">title</span><span class="o">=</span> <span class="s2">&quot; IPERM = &quot;</span> <span class="p">)</span>
</code></pre></div>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-xadj~5"></span>integer(kind=I4B),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>XADJ</strong>(:)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-adjncy~5"></span>integer(kind=I4B),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ADJNCY</strong>(:)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-perm~4"></span>integer(kind=I4B),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>PERM</strong>(:)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-iperm~6"></span>integer(kind=I4B),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>IPERM</strong>(:)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-options~5"></span>integer(kind=I4B),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td>TARGET</td><td>::</td>
  <td><strong>OPTIONS</strong>(:)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-vwgt~5"></span>integer(kind=I4B),</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td>TARGET</td><td>::</td>
  <td><strong>VWGT</strong>(:)</td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<em>None</em>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>EASIFEM-BASE was developed by Vikas Sharma<br>&copy; 2021 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
             on 2021-10-02 00:01  
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>